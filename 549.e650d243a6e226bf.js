"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[549],{513:(Ut,b,c)=>{c.r(b),c.d(b,{BillModule:()=>wt});var f=c(70085),g=c(69808),h=c(93075),r=c(98952),T=c(88205),C=c(40845),Z=c(25787),x=c(17773),B=c(44534),L=c(98018),A=c(31424),P=c(73407),v=c(14036),I=c(49603),E=c(7010),y=c(15315),N=c(51122),M=c(44930),F=c(94327),_=c(41777),t=c(5e3),d=c(54004),k=c(92340),O=c(81637),$=c(40520);let u=`${O.Z.DEFAULT_URLS.API}/Bills`,S=(()=>{class l{constructor(e){this.http=e}getPagingBills(e){return this.http.get(`${u}`,{params:e}).pipe((0,d.U)(n=>n))}getAllBills(){return this.http.get(`${u}/list`,{}).pipe((0,d.U)(e=>e))}getBillDetail(e){return this.http.get(`${u}/${e}`,{}).pipe((0,d.U)(i=>i))}createBill(e){return this.http.post(`${u}`,e).pipe((0,d.U)(i=>i))}updateBill(e,n){return this.http.put(`${u}/${n}`,e).pipe((0,d.U)(o=>o))}deleteBill(e){return this.http.delete(`${u}/${e}`,{}).pipe((0,d.U)(i=>i))}deleteMultipleBill(e){return this.http.put(`${u}/multiple`,e).pipe()}getExcelReport(e){return this.http.get(`${u}/export-excel-customer`,{}).pipe((0,d.U)(i=>i))}getFolderPathDownload(e,n){return k.N.serverURL+`/ReportDownload/DownloadReportFromFile?filename=${e}&fileType=${n}`}}return l.\u0275fac=function(e){return new(e||l)(t.LFG($.eN))},l.\u0275prov=t.Yz7({token:l,factory:l.\u0275fac}),l})();var w=c(59783),D=c(62162),U=c(373),R=c(21726),Y=c(74297);function G(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"div",19)(1,"button",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openNew())}),t.qZA(),t.TgZ(2,"button",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteSelectedAccessories())}),t.qZA()()}if(2&l){const e=t.oxw();t.xp6(2),t.Q6J("disabled",!e.selectedAccessories||!e.selectedAccessories.length)}}function K(l,s){if(1&l){const e=t.EpF();t._UZ(0,"p-fileUpload",22),t.TgZ(1,"button",23),t.NdJ("click",function(){t.CHM(e),t.oxw();const i=t.MAs(8);return t.KtG(i.exportCSV())}),t.qZA(),t.TgZ(2,"button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.exportExcel())}),t.qZA(),t.TgZ(3,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.exportPdf())}),t.qZA(),t.TgZ(4,"button",26),t.NdJ("click",function(){t.CHM(e),t.oxw();const i=t.MAs(8);return t.KtG(i.exportCSV({selectionOnly:!0}))}),t.qZA()}2&l&&t.Q6J("maxFileSize",1e6)}function Q(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"div",27)(1,"h5",28),t._uU(2,"Bills management"),t.qZA(),t.TgZ(3,"span",29),t._UZ(4,"i",30),t.TgZ(5,"input",31),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.getParams.searchText=i)})("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.getBills())}),t.qZA()()()}if(2&l){const e=t.oxw();t.xp6(5),t.Q6J("ngModel",e.getParams.searchText)}}function H(l,s){1&l&&(t.TgZ(0,"tr"),t._UZ(1,"th",32),t.TgZ(2,"th"),t._uU(3,"Bill ID"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Customer ID"),t.qZA(),t.TgZ(6,"th",33),t._uU(7,"Bill Code"),t._UZ(8,"p-sortIcon",34),t.qZA(),t.TgZ(9,"th",35),t._uU(10,"Total Amount"),t._UZ(11,"p-sortIcon",36),t.qZA(),t.TgZ(12,"th",37),t._uU(13,"Delivery Status"),t._UZ(14,"p-sortIcon",38),t.qZA(),t.TgZ(15,"th",39),t._uU(16,"Bill Status"),t._UZ(17,"p-sortIcon",40),t.qZA(),t.TgZ(18,"th",41),t._uU(19,"Description"),t._UZ(20,"p-sortIcon",42),t.qZA(),t._UZ(21,"th",43),t.qZA())}function V(l,s){if(1&l&&t._UZ(0,"p-badge",49),2&l){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("value",n.getDeliveryName(e.deliveryStatus))("severity",n.getDeliveryStatusColor(e.deliveryStatus))}}function j(l,s){if(1&l&&t._UZ(0,"p-badge",49),2&l){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("value",n.getStatusName(e.billStatus))("severity",n.getBillStatusColor(e.billStatus))}}function z(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._UZ(2,"button",44),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"td"),t.YNc(13,V,1,2,"p-badge",45),t.qZA(),t.TgZ(14,"td"),t.YNc(15,j,1,2,"p-badge",45),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.qZA(),t.TgZ(18,"td",43)(19,"div",46)(20,"button",47),t.NdJ("click",function(){const o=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.editBill(o))}),t.qZA(),t.TgZ(21,"button",48),t.NdJ("click",function(){const o=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.deleteBill(o))}),t.qZA()()()()}if(2&l){const e=s.$implicit,n=s.expanded,i=t.oxw();t.xp6(2),t.Q6J("pRowToggler",e)("icon",n?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(i.getCustomerName(e.customeRId)),t.xp6(2),t.Oqu(e.billCode),t.xp6(2),t.Oqu(t.lcZ(11,9,e.totalAmount)),t.xp6(3),t.Q6J("ngIf",e.deliveryStatus),t.xp6(2),t.Q6J("ngIf",e.billStatus),t.xp6(2),t.Oqu(e.description)}}function X(l,s){1&l&&(t.TgZ(0,"tr")(1,"th",54),t._uU(2,"Bill ID "),t._UZ(3,"p-sortIcon",55),t.qZA(),t.TgZ(4,"th",56),t._uU(5,"ImeI ID "),t._UZ(6,"p-sortIcon",57),t.qZA(),t.TgZ(7,"th",58),t._uU(8,"Accessory ID "),t._UZ(9,"p-sortIcon",59),t.qZA(),t.TgZ(10,"th",60),t._uU(11,"Price"),t._UZ(12,"p-sortIcon",61),t.qZA(),t.TgZ(13,"th",62),t._uU(14,"Quantity"),t._UZ(15,"p-sortIcon",63),t.qZA(),t.TgZ(16,"th",64),t._uU(17,"Battery Percent"),t._UZ(18,"p-sortIcon",65),t.qZA()())}function W(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.ALo(9,"number"),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.ALo(12,"number"),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA()()),2&l){const e=s.$implicit,n=t.oxw(2);t.xp6(2),t.Oqu(e.bilLId),t.xp6(2),t.Oqu(n.getImeiName(e.imeIId)),t.xp6(2),t.Oqu(n.getAccessoryName(e.accessorYId)),t.xp6(2),t.Oqu(t.lcZ(9,6,e.price)),t.xp6(3),t.Oqu(t.lcZ(12,8,e.quantity)),t.xp6(3),t.hij("",e.batteryPercent," %")}}function tt(l,s){1&l&&(t.TgZ(0,"tr")(1,"td",66),t._uU(2,"There are no order for this bill detail yet."),t.qZA()())}function et(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td",50)(2,"div",51)(3,"p-table",52),t.YNc(4,X,19,0,"ng-template",9),t.YNc(5,W,15,10,"ng-template",10),t.YNc(6,tt,3,0,"ng-template",53),t.qZA()()()()),2&l){const e=s.$implicit;t.xp6(3),t.Q6J("value",e.billDetails)}}function lt(l,s){1&l&&(t.TgZ(0,"small",87),t._uU(1,"Customer ID is required."),t.qZA())}function it(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"div",88)(1,"p-radioButton",89),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw(2);return t.KtG(o.selectedBillStatus=i)}),t.qZA(),t.TgZ(2,"label",90),t._uU(3),t.qZA()()}if(2&l){const e=s.$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("inputId",e.key)("value",e)("ngModel",n.selectedBillStatus),t.xp6(1),t.Q6J("for",e.key),t.xp6(1),t.Oqu(e.name)}}function nt(l,s){1&l&&(t.TgZ(0,"small",87),t._uU(1,"Description is required."),t.qZA())}function ot(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"div",91)(1,"h4"),t._uU(2,"Bill Details"),t.qZA(),t.TgZ(3,"div")(4,"button",92),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onAddBillDetail())}),t.qZA()()()}2&l&&(t.xp6(4),t.Q6J("label","Add"))}function st(l,s){1&l&&(t.TgZ(0,"tr")(1,"th",93),t._uU(2,"Imei Id"),t.qZA(),t.TgZ(3,"th",93),t._uU(4,"Accessory Id"),t.qZA(),t.TgZ(5,"th",94),t._uU(6,"Price"),t.qZA(),t.TgZ(7,"th",94),t._uU(8,"Quantity"),t.qZA(),t.TgZ(9,"th",94),t._uU(10,"Battery percent"),t.qZA(),t._UZ(11,"th",94),t.qZA())}function ct(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-dropdown",102),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.imeIId=i)}),t.qZA()}if(2&l){const e=t.oxw().$implicit,n=t.oxw(2);t.Q6J("options",n.imeis)("ngModel",e.imeIId)("showClear",!0)}}function at(l,s){if(1&l&&t._uU(0),2&l){const e=t.oxw().$implicit,n=t.oxw(2);t.hij(" ",n.getImeiName(e.imeIId)," ")}}function pt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-dropdown",103),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.accessorYId=i)}),t.qZA()}if(2&l){const e=t.oxw().$implicit,n=t.oxw(2);t.Q6J("options",n.accessories)("ngModel",e.accessorYId)("showClear",!0)}}function rt(l,s){if(1&l&&t._uU(0),2&l){const e=t.oxw().$implicit,n=t.oxw(2);t.hij(" ",n.getAccessoryName(e.accessorYId)," ")}}function ut(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-inputNumber",76),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.price=i)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.price)}}function _t(l,s){if(1&l&&(t._uU(0),t.ALo(1,"number")),2&l){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.price)," ")}}function dt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-inputNumber",76),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.quantity=i)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.quantity)}}function mt(l,s){if(1&l&&(t._uU(0),t.ALo(1,"number")),2&l){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.quantity)," ")}}function gt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-inputNumber",76),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.batteryPercent=i)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.batteryPercent)}}function ht(l,s){if(1&l&&t._uU(0),2&l){const e=t.oxw().$implicit;t.hij(" ",e.batteryPercent," % ")}}function bt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",104),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.onRowEditInit(i))}),t.qZA()}}function ft(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",105),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.onRowEditSave(i))}),t.qZA()}}function Tt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",106),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),o=i.$implicit,p=i.rowIndex,Dt=t.oxw(2);return t.KtG(Dt.onRowEditCancel(o,p))}),t.qZA()}}function Ct(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr",95)(1,"td")(2,"p-cellEditor"),t.YNc(3,ct,1,3,"ng-template",96),t.YNc(4,at,1,1,"ng-template",97),t.qZA()(),t.TgZ(5,"td")(6,"p-cellEditor"),t.YNc(7,pt,1,3,"ng-template",96),t.YNc(8,rt,1,1,"ng-template",97),t.qZA()(),t.TgZ(9,"td")(10,"p-cellEditor"),t.YNc(11,ut,1,1,"ng-template",96),t.YNc(12,_t,2,3,"ng-template",97),t.qZA()(),t.TgZ(13,"td")(14,"p-cellEditor"),t.YNc(15,dt,1,1,"ng-template",96),t.YNc(16,mt,2,3,"ng-template",97),t.qZA()(),t.TgZ(17,"td")(18,"p-cellEditor"),t.YNc(19,gt,1,1,"ng-template",96),t.YNc(20,ht,1,1,"ng-template",97),t.qZA()(),t.TgZ(21,"td")(22,"div",98),t.YNc(23,bt,1,0,"button",99),t.YNc(24,ft,1,0,"button",100),t.YNc(25,Tt,1,0,"button",101),t.TgZ(26,"button",48),t.NdJ("click",function(){const o=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.deleteBillDetail(o))}),t.qZA()()()()}if(2&l){const n=s.editing;t.Q6J("pEditableRow",s.$implicit),t.xp6(23),t.Q6J("ngIf",!n),t.xp6(1),t.Q6J("ngIf",n),t.xp6(1),t.Q6J("ngIf",n)}}const q=function(){return{"margin-bottom":"2em"}},Zt=function(l){return{"ng-invalid ng-dirty":l}};function xt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-card",67)(1,"div",68)(2,"div",69)(3,"label",70),t._uU(4,"Bill Code"),t.qZA(),t.TgZ(5,"input",71),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.billCode=i)}),t.qZA()(),t.TgZ(6,"div",69)(7,"label",72),t._uU(8,"Customer ID"),t.qZA(),t.TgZ(9,"p-dropdown",73),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.customeRId=i)}),t.qZA(),t.YNc(10,lt,2,0,"small",74),t.qZA(),t.TgZ(11,"div",69)(12,"label",75),t._uU(13,"Total Amount"),t.qZA(),t.TgZ(14,"p-inputNumber",76),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.totalAmount=i)}),t.qZA()(),t.TgZ(15,"div",77)(16,"label",78),t._uU(17,"Delivery Status"),t.qZA(),t.TgZ(18,"p-dropdown",79),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.selectedDeliveryStatus=i)}),t.qZA()(),t.TgZ(19,"div",77)(20,"label",80),t._uU(21,"Bill Status"),t.qZA(),t.TgZ(22,"div",81),t.YNc(23,it,4,5,"div",82),t.qZA()(),t.TgZ(24,"div",83)(25,"label",84),t._uU(26,"Description"),t.qZA(),t.TgZ(27,"input",85),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.description=i)}),t.qZA(),t.YNc(28,nt,2,0,"small",74),t.qZA()()(),t.TgZ(29,"p-card"),t.YNc(30,ot,5,1,"ng-template",9),t.TgZ(31,"p-table",86),t.YNc(32,st,12,0,"ng-template",9),t.YNc(33,Ct,27,4,"ng-template",10),t.qZA()()}if(2&l){const e=t.oxw();t.Akn(t.DdM(18,q)),t.xp6(5),t.Q6J("ngModel",e.bill.billCode),t.xp6(4),t.Q6J("options",e.customers)("ngModel",e.bill.customeRId)("showClear",!0),t.xp6(1),t.Q6J("ngIf",e.submitted&&!e.bill.customeRId),t.xp6(4),t.Q6J("ngModel",e.bill.totalAmount),t.xp6(4),t.Q6J("options",e.deliveryStatus)("ngModel",e.selectedDeliveryStatus)("showClear",!0),t.xp6(5),t.Q6J("ngForOf",e.billStatus),t.xp6(4),t.Q6J("ngModel",e.bill.description)("ngClass",t.VKq(19,Zt,e.submitted&&!e.bill.description)),t.xp6(1),t.Q6J("ngIf",e.submitted&&!e.bill.description),t.xp6(1),t.Akn(t.DdM(21,q)),t.xp6(2),t.Q6J("value",e.billDetails)}}function Bt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",107),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.hideDialog())}),t.qZA(),t.TgZ(1,"button",108),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.saveBill())}),t.qZA()}}function At(l,s){if(1&l&&(t.TgZ(0,"span"),t._uU(1,"Are you sure you want to delete "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"?"),t.qZA()),2&l){const e=t.oxw();t.xp6(3),t.Oqu(e.bill.billCode)}}function vt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",109),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteBillDialog=!1)}),t.qZA(),t.TgZ(1,"button",110),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.confirmDelete())}),t.qZA()}}function It(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",109),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteAccessoriesDialog=!1)}),t.qZA(),t.TgZ(1,"button",110),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.confirmDeleteSelected())}),t.qZA()}}const Et=function(){return["billCode","totalAmount","deliveryStatus","billStatus"]},yt=function(){return[5,10,20]},Nt=function(){return{width:"70%"}},J=function(){return{width:"450px"}};var m=(()=>{return(l=m||(m={}))[l.NOT_YET_PAYMENT=1]="NOT_YET_PAYMENT",l[l.PAYMENT_COMPLETED=2]="PAYMENT_COMPLETED",m;var l})(),a=(()=>{return(l=a||(a={}))[l.NOT_YET_DELIVERY=1]="NOT_YET_DELIVERY",l[l.DELIVERING=2]="DELIVERING",l[l.DELIVERED=3]="DELIVERED",l[l.DELIVERY_FAILED=4]="DELIVERY_FAILED",l[l.DELIVERY_CANCEL=5]="DELIVERY_CANCEL",a;var l})();let Mt=(()=>{class l{constructor(e,n,i,o,p){this.billService=e,this.messageService=n,this.imeiService=i,this.accessoryService=o,this.customerService=p,this.billDialog=!1,this.deleteBillDialog=!1,this.deleteAccessoriesDialog=!1,this.bill={},this.selectedAccessories=[],this.submitted=!1,this.cols=[],this.rowsPerPageOptions=[5,10,20],this.selectedBillStatus=null,this.billStatus=[{name:"Ch\u01b0a Thanh To\xe1n",key:m.NOT_YET_PAYMENT},{name:"\u0110\xe3 Thanh To\xe1n",key:m.PAYMENT_COMPLETED}],this.selectedDeliveryStatus=null,this.deliveryStatus=[{name:"Ch\u01b0a giao h\xe0ng",code:a.NOT_YET_DELIVERY},{name:"\u0110ang giao h\xe0ng",code:a.DELIVERING},{name:"Giao h\xe0ng th\xe0nh c\xf4ng",code:a.DELIVERED},{name:"Giao h\xe0ng l\u1ed7i",code:a.DELIVERY_FAILED},{name:"\u0110\u01a1n h\xe0ng b\u1ecb h\u1ee7y",code:a.DELIVERY_CANCEL}],this.billDetails=[],this.statuses=[],this.customers=[],this.imeis=[],this.accessories=[],this.loading=!1,this.getParams={page:0,pageSize:5,sortField:"id",isSort:!0,searchText:""},this.lstBill=[],this.bills=[],this.totalRecords=0,this.totalPages=0,this.first=0,this.clonedProducts={}}ngOnInit(){this.getListCustomer(),this.getListImei(),this.getListAccessories(),this.cols=[{field:"accessoryName",header:"Accessory name"},{field:"salePrice",header:"Sale Price"},{field:"description",header:"Description"}],this.statuses=[{label:"In Stock",value:"INSTOCK"},{label:"Low Stock",value:"LOWSTOCK"},{label:"Out of Stock",value:"OUTOFSTOCK"}]}getBillStatusColor(e){switch(e){case m.NOT_YET_PAYMENT:return"info";case m.PAYMENT_COMPLETED:return"success"}return""}getDeliveryStatusColor(e){switch(e){case a.NOT_YET_DELIVERY:return"info";case a.DELIVERING:return"warning";case a.DELIVERED:return"success";case a.DELIVERY_FAILED:case a.DELIVERY_CANCEL:return"error"}return""}getListCustomer(){this.customerService.getAllCustomer().subscribe(e=>{this.customers=e.data})}getListImei(){this.imeiService.getAllImei().subscribe(e=>{this.imeis=e.data})}getCustomerName(e){let n=this.customers.find(i=>i.id===e);return n?n.customerName:""}getImeiName(e){let n=this.imeis.find(i=>i.id===e);return n?n.imeiName:""}getAccessoryName(e){let n=this.accessories.find(i=>i.id===e);return n?n.accessoryName:""}getListAccessories(){this.accessoryService.getAllAccessor().subscribe(e=>{this.accessories=e.data})}getBills(e,n=!1){this.pendingRequest&&this.pendingRequest.unsubscribe(),this.loading=!0,e&&(console.log(e),this.getParams.page=e.first/e.rows,this.getParams.pageSize=e.rows+1,this.getParams.sortField=e.sortField,this.getParams.isSort=1===e.sortOrder),n&&this.billService.getExcelReport(this.getParams).subscribe(i=>{M.Z.scrollToTop(),this.openDownloadFile(i.data,"excel")}),Object.keys(this.getParams).forEach(i=>null==this.getParams[i]&&delete this.getParams[i]),this.pendingRequest=this.billService.getPagingBills(this.getParams).subscribe(i=>{M.Z.scrollToTop(),this.lstBill=i.data,this.totalRecords=i.totalItems||0,this.totalPages=i.totalItems/i.pageSize,console.log(this.lstBill),this.loading=!1})}openDownloadFile(e,n){try{var i=this.billService.getFolderPathDownload(e,n);i&&window.open(i)}catch(o){this.messageService.add({severity:"error",summary:"Error Message",detail:"File invalid"})}}openNew(){this.bill={},this.submitted=!1,this.billDialog=!0,this.resetValue()}deleteSelectedAccessories(){this.deleteAccessoriesDialog=!0}editBill(e){this.bill=Object.assign({},e),this.selectedBillStatus=this.billStatus.filter(n=>n.key===e.billStatus)[0],this.selectedDeliveryStatus=this.deliveryStatus.filter(n=>n.code===e.deliveryStatus)[0],this.billDetails=e.billDetails||[],this.billDialog=!0}resetValue(){this.selectedDeliveryStatus=null,this.selectedBillStatus=null}deleteBill(e){this.deleteBillDialog=!0,this.bill=Object.assign({},e)}confirmDeleteSelected(){this.billService.deleteMultipleBill(this.selectedAccessories.map(e=>e.id)).subscribe(()=>{this.deleteAccessoriesDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"accessories Deleted",life:3e3}),this.selectedAccessories=[],this.getBills()})}confirmDelete(){this.billService.deleteBill(this.bill.id).subscribe(e=>{this.deleteBillDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Deleted",life:3e3}),this.bill={},this.getBills()})}hideDialog(){this.billDialog=!1,this.submitted=!1,this.bill={},this.getBills()}saveBill(){var e,n;null!==(e=this.bill.billDetails)&&void 0!==e&&e.map(i=>i.imeIId&&i.accessorY_ID||!i.imeIId&&!i.accessorY_ID)?this.messageService.add({severity:"info",summary:"Information",detail:"Please check again"}):(this.submitted=!0,this.bill.customeR_ID=this.bill.customeRId,this.bill.billStatus=this.selectedBillStatus.key,this.bill.deliveryStatus=this.selectedDeliveryStatus.code,console.log(this.bill.billDetails),null===(n=this.bill.billDetails)||void 0===n||n.forEach(i=>{i.bilL_ID=i.bilLId,i.imeI_ID=i.imeIId,i.accessorY_ID=i.accessorYId}),this.bill.id?this.billService.updateBill(this.bill,this.bill.id).subscribe(i=>{console.log(i),this.messageService.add({severity:"success",summary:"Successful",detail:"accessory Updated",life:3e3}),this.hideDialog()}):(this.bill.id=0,this.billService.createBill(this.bill).subscribe(i=>{console.log(i),this.messageService.add({severity:"success",summary:"Successful",detail:"accessory Created",life:3e3}),this.hideDialog()})))}getDeliveryName(e){let n=this.deliveryStatus.find(i=>i.code===e);return n?n.name:""}getStatusName(e){let n=this.billStatus.find(i=>i.key===e);return n?n.name:""}findIndexById(e){let n=-1;for(let i=0;i<this.bills.length;i++)if(this.bills[i].id===e){n=i;break}return n}onAddBillDetail(){this.billDetails.push({imeIId:0,accessorYId:0,price:0,quantity:1,batteryPercent:0})}createId(){let e="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<6;i++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}onGlobalFilter(e,n){e.filterGlobal(n.target.value,"contains")}exportPdf(){c.e(583).then(c.bind(c,53583)).then(e=>{Promise.all([c.e(583),c.e(983)]).then(c.t.bind(c,12983,23)).then(n=>{const i=new e.default;i.autoTable(this.cols,this.bills),i.save("accessory.pdf")})})}exportExcel(){c.e(574).then(c.bind(c,80574)).then(e=>{const i={Sheets:{data:e.utils.json_to_sheet(this.bills)},SheetNames:["data"]},o=e.write(i,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(o,"accessories")})}saveAsExcelFile(e,n){const p=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});F.saveAs(p,n+"_export_"+(new Date).getTime()+".xlsx")}onRowEditInit(e){this.clonedProducts[e.id]=Object.assign({},e)}onRowEditSave(e){delete this.clonedProducts[e.id]}onRowEditCancel(e,n){this.billDetails[n]=this.clonedProducts[e.id],delete this.clonedProducts[e.id]}deleteBillDetail(e){console.log(e)}}return l.\u0275fac=function(e){return new(e||l)(t.Y36(S),t.Y36(w.ez),t.Y36(D.s),t.Y36(U.r),t.Y36(R.v))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-bill"]],decls:27,vars:30,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["styleClass","mb-4"],["pTemplate","left"],["pTemplate","right"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple",3,"value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","first","lazy","totalRecords","selection","firstChange","onLazyLoad","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["header","Bill Details",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],[1,"my-2"],["pButton","","pRipple","","label","New","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger",3,"disabled","click"],["mode","basic","accept","image/*","label","Import","chooseLabel","Import",1,"mr-2","inline-block",3,"maxFileSize"],["pButton","","pRipple","","label","Export","icon","pi pi-upload",1,"p-button-help","mr-2",3,"click"],["type","button","pButton","","pRipple","","icon","pi pi-file-excel","pTooltip","XLS","tooltipPosition","bottom",1,"p-button-success","mr-2",3,"click"],["type","button","pButton","","pRipple","","icon","pi pi-file-pdf","pTooltip","PDF","tooltipPosition","bottom",1,"p-button-warning","mr-2",3,"click"],["type","button","pButton","","pRipple","","icon","pi pi-filter","pTooltip","Selection Only","tooltipPosition","bottom",1,"p-button-info","ml-auto",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",1,"w-full","sm:w-auto",3,"ngModel","ngModelChange","change"],[2,"width","3rem"],["pSortableColumn","billCode"],["field","billCode"],["pSortableColumn","totalAmount"],["field","totalAmount"],["pSortableColumn","deliveryStatus"],["field","deliveryStatus"],["pSortableColumn","billStatus"],["field","billStatus"],["pSortableColumn","description"],["field","description"],[1,"w-2"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],[3,"value","severity",4,"ngIf"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-warning","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[3,"value","severity"],["colspan","12"],[1,"p-3"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["pSortableColumn","bilLId"],["field","bilLId"],["pSortableColumn","imeIId"],["field","imeIId"],["pSortableColumn","accessorYId"],["field","accessorYId"],["pSortableColumn","price"],["field","price"],["pSortableColumn","quantity"],["field","quantity"],["pSortableColumn","batteryPercent"],["field","batteryPercent"],["colspan","6"],["header","Bill Information"],[1,"form-grid","grid"],[1,"field","col-12","md:col-4"],["for","billCode"],["type","text","pInputText","","id","billCode","autofocus","",3,"ngModel","ngModelChange"],["for","customeRId"],["placeholder","Select Customer","optionLabel","customerName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["class","ng-dirty ng-invalid",4,"ngIf"],["for","totalAmount"],[3,"ngModel","ngModelChange"],[1,"field","col-12","md:col-6"],["for","deliveryStatus"],["placeholder","Select delivery status","optionLabel","name",3,"options","ngModel","showClear","ngModelChange"],["for","billStatus"],[1,"flex","gap-8"],["class","field-checkbox",4,"ngFor","ngForOf"],[1,"field","col-12"],["for","description"],["type","text","pInputText","","id","description","required","",3,"ngModel","ngClass","ngModelChange"],["dataKey","id","editMode","row",3,"value"],[1,"ng-dirty","ng-invalid"],[1,"field-checkbox"],["name","billStatus",3,"inputId","value","ngModel","ngModelChange"],[3,"for"],[1,"flex","justify-content-between","px-4","pt-4"],["pButton","","pRipple","","icon","pi pi-plus",3,"label","click"],[2,"width","20%"],[2,"width","15%"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","icon","pi pi-pencil","class","p-button-rounded p-button-warning","pInitEditableRow","",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","class","p-button-rounded p-button-text p-button-success mr-2",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","class","p-button-rounded p-button-text p-button-danger",3,"click",4,"ngIf"],["placeholder","Select Imei","optionLabel","imeiName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["placeholder","Select Accessory","optionLabel","accessoryName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["pButton","","pRipple","","icon","pi pi-pencil","pInitEditableRow","",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check",1,"p-button-rounded","p-button-text","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"p-toast"),t.TgZ(4,"p-toolbar",3),t.YNc(5,G,3,1,"ng-template",4),t.YNc(6,K,5,1,"ng-template",5),t.qZA(),t.TgZ(7,"p-table",6,7),t.NdJ("firstChange",function(o){return n.first=o})("onLazyLoad",function(o){return n.getBills(o)})("selectionChange",function(o){return n.selectedAccessories=o}),t.YNc(9,Q,6,1,"ng-template",8),t.YNc(10,H,22,0,"ng-template",9),t.YNc(11,z,22,11,"ng-template",10),t.YNc(12,et,7,1,"ng-template",11),t.qZA()()()(),t.TgZ(13,"p-dialog",12),t.NdJ("visibleChange",function(o){return n.billDialog=o}),t.YNc(14,xt,34,22,"ng-template",13),t.YNc(15,Bt,2,0,"ng-template",14),t.qZA(),t.TgZ(16,"p-dialog",15),t.NdJ("visibleChange",function(o){return n.deleteBillDialog=o}),t.TgZ(17,"div",16),t._UZ(18,"i",17),t.YNc(19,At,5,1,"span",18),t.qZA(),t.YNc(20,vt,2,0,"ng-template",14),t.qZA(),t.TgZ(21,"p-dialog",15),t.NdJ("visibleChange",function(o){return n.deleteAccessoriesDialog=o}),t.TgZ(22,"div",16),t._UZ(23,"i",17),t.TgZ(24,"span"),t._uU(25,"Are you sure you want to delete selected accessory?"),t.qZA()(),t.YNc(26,It,2,0,"ng-template",14),t.qZA()),2&e&&(t.xp6(7),t.Q6J("value",n.lstBill)("columns",n.cols)("rows",10)("globalFilterFields",t.DdM(25,Et))("paginator",!0)("rowsPerPageOptions",t.DdM(26,yt))("showCurrentPageReport",!0)("first",n.first)("lazy",!0)("totalRecords",n.totalRecords)("selection",n.selectedAccessories)("totalRecords",n.totalRecords),t.xp6(6),t.Akn(t.DdM(27,Nt)),t.Q6J("visible",n.billDialog)("modal",!0),t.xp6(3),t.Akn(t.DdM(28,J)),t.Q6J("visible",n.deleteBillDialog)("modal",!0),t.xp6(3),t.Q6J("ngIf",n.bill),t.xp6(2),t.Akn(t.DdM(29,J)),t.Q6J("visible",n.deleteAccessoriesDialog)("modal",!0))},dependencies:[g.mk,g.sg,g.O5,r.iA,w.jx,r.lQ,r.jB,r.YL,r.fz,r.D$,r.Pv,r.U1,r.wT,T.p,C.Hq,h.Fj,h.JJ,h.Q7,h.On,Z.H,x.FN,B.o,A.o,v.Lt,I.EU,E.Rn,y.V,Y.Z,f.Ct,g.JJ],encapsulation:2,data:{animation:[(0,_.X$)("rowExpansionTrigger",[(0,_.SB)("void",(0,_.oB)({transform:"translateX(-10%)",opacity:0})),(0,_.SB)("active",(0,_.oB)({transform:"translateX(0)",opacity:1})),(0,_.eR)("* <=> *",(0,_.jt)("400ms cubic-bezier(0.86, 0, 0.07, 1)"))])]}}),l})(),St=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[N.Bz.forChild([{path:"",component:Mt}]),N.Bz]}),l})(),wt=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({providers:[R.v,U.r,S,D.s],imports:[g.ez,St,r.U$,T.O,h.u5,C.hJ,Z.T,x.EV,B.V,L.Xt,A.j,P.A,v.kW,I.cc,E.L$,y.S,Y.d,f.TX]}),l})()}}]);