"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[475],{98475:(Nt,h,s)=>{s.r(h),s.d(h,{BillModule:()=>vt});var b=s(70085),m=s(69808),u=s(93075),r=s(98952),R=s(88205),f=s(40845),T=s(25787),Z=s(17773),C=s(44534),J=s(98018),x=s(31424),U=s(73407),B=s(14036),A=s(49603),v=s(7010),E=s(15315),N=s(51122),g=s(44930),P=s(94327),_=s(41777),t=s(5e3),y=s(84451),I=s(59783),M=s(62162),w=s(373),S=s(21726),D=s(74297),L=s(27232);function O(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"div",18)(1,"button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openNew())}),t.qZA(),t.TgZ(2,"button",20),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteSelectedBills())}),t.qZA()()}if(2&l){const e=t.oxw();t.xp6(2),t.Q6J("disabled",!e.selectedBills||!e.selectedBills.length)}}function F(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"div",21)(1,"h5",22),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",23),t._UZ(5,"i",24),t.TgZ(6,"input",25),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.getParams.searchText=n)})("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.getBills())}),t.qZA()()()}if(2&l){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,2,"label.bill_management")),t.xp6(4),t.Q6J("ngModel",e.getParams.searchText)}}function k(l,a){1&l&&(t.TgZ(0,"tr"),t._UZ(1,"th",26),t.TgZ(2,"th")(3,"div",27),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"th")(7,"div",28),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"th",29)(11,"div",28),t._uU(12),t.ALo(13,"translate"),t._UZ(14,"p-sortIcon",30),t.qZA()(),t.TgZ(15,"th",31)(16,"div",28),t._uU(17),t.ALo(18,"translate"),t._UZ(19,"p-sortIcon",32),t.qZA()(),t.TgZ(20,"th",33)(21,"div",34),t._uU(22),t.ALo(23,"translate"),t._UZ(24,"p-sortIcon",35),t.qZA()(),t.TgZ(25,"th",36)(26,"div",37),t._uU(27),t.ALo(28,"translate"),t._UZ(29,"p-sortIcon",38),t.qZA()(),t._UZ(30,"th",39),t.qZA()),2&l&&(t.xp6(4),t.hij(" ",t.lcZ(5,6,"label.bill_id")," "),t.xp6(4),t.hij(" ",t.lcZ(9,8,"label.customer_name")," "),t.xp6(4),t.hij(" ",t.lcZ(13,10,"label.bill_code")," "),t.xp6(5),t.hij(" ",t.lcZ(18,12,"label.total_amount")," "),t.xp6(5),t.hij(" ",t.lcZ(23,14,"label.delivery_status")," "),t.xp6(5),t.hij(" ",t.lcZ(28,16,"label.bill_status")," "))}function G(l,a){if(1&l&&t._UZ(0,"p-badge",45),2&l){const e=t.oxw().$implicit,i=t.oxw();t.Q6J("value",i.getDeliveryName(e.deliveryStatus))("severity",i.getDeliveryStatusColor(e.deliveryStatus))}}function Q(l,a){if(1&l&&t._UZ(0,"p-badge",45),2&l){const e=t.oxw().$implicit,i=t.oxw();t.Q6J("value",i.getStatusName(e.billStatus))("severity",i.getBillStatusColor(e.billStatus))}}function K(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._UZ(2,"button",40),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"td"),t.YNc(13,G,1,2,"p-badge",41),t.qZA(),t.TgZ(14,"td"),t.YNc(15,Q,1,2,"p-badge",41),t.qZA(),t.TgZ(16,"td",39)(17,"div",42)(18,"button",43),t.NdJ("click",function(){const o=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.editBill(o))}),t.qZA(),t.TgZ(19,"button",44),t.NdJ("click",function(){const o=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.deleteBill(o))}),t.qZA()()()()}if(2&l){const e=a.$implicit,i=a.expanded,n=t.oxw();t.xp6(2),t.Q6J("pRowToggler",e)("icon",i?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(n.getCustomerName(e.customeRId)),t.xp6(2),t.Oqu(e.billCode),t.xp6(2),t.Oqu(t.lcZ(11,8,e.totalAmount)),t.xp6(3),t.Q6J("ngIf",e.deliveryStatus),t.xp6(2),t.Q6J("ngIf",e.billStatus)}}function $(l,a){1&l&&(t.TgZ(0,"tr")(1,"th",50),t._uU(2,"ImeI ID "),t._UZ(3,"p-sortIcon",51),t.qZA(),t.TgZ(4,"th",52),t._uU(5,"Accessory ID "),t._UZ(6,"p-sortIcon",53),t.qZA(),t.TgZ(7,"th",54),t._uU(8,"Price"),t._UZ(9,"p-sortIcon",55),t.qZA(),t.TgZ(10,"th",56),t._uU(11,"Quantity"),t._UZ(12,"p-sortIcon",57),t.qZA(),t.TgZ(13,"th",58),t._uU(14,"Battery Percent"),t._UZ(15,"p-sortIcon",59),t.qZA()())}function H(l,a){if(1&l&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"number"),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA()()),2&l){const e=a.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(i.getImeiName(e.imeIId)),t.xp6(2),t.Oqu(i.getAccessoryName(e.accessorYId)),t.xp6(2),t.Oqu(t.lcZ(7,5,e.price)),t.xp6(3),t.Oqu(t.lcZ(10,7,e.quantity)),t.xp6(3),t.hij("",e.batteryPercent," %")}}function j(l,a){1&l&&(t.TgZ(0,"tr")(1,"td",60),t._uU(2,"There are no order for this bill detail yet."),t.qZA()())}function V(l,a){if(1&l&&(t.TgZ(0,"tr")(1,"td",46)(2,"div",47)(3,"p-table",48),t.YNc(4,$,16,0,"ng-template",8),t.YNc(5,H,13,9,"ng-template",9),t.YNc(6,j,3,0,"ng-template",49),t.qZA()()()()),2&l){const e=a.$implicit;t.xp6(3),t.Q6J("value",e.billDetails)}}function z(l,a){1&l&&(t.TgZ(0,"small",81),t._uU(1,"Customer ID is required."),t.qZA())}function X(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"div",82)(1,"p-radioButton",83),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw(2);return t.KtG(o.selectedBillStatus=n)}),t.qZA(),t.TgZ(2,"label",84),t._uU(3),t.qZA()()}if(2&l){const e=a.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("inputId",e.key)("value",e)("ngModel",i.selectedBillStatus),t.xp6(1),t.Q6J("for",e.key),t.xp6(1),t.Oqu(e.name)}}function W(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"div",85)(1,"h4"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div")(5,"button",86),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onAddBillDetail())}),t.qZA()()()}2&l&&(t.xp6(2),t.Oqu(t.lcZ(3,2,"label.bill_detail_management")),t.xp6(3),t.Q6J("label","Add"))}function tt(l,a){1&l&&(t.TgZ(0,"tr")(1,"th",87),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"th",87),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"th",88),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"th",88),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"th",88),t._uU(14),t.ALo(15,"translate"),t.qZA(),t._UZ(16,"th",88),t.qZA()),2&l&&(t.xp6(2),t.Oqu(t.lcZ(3,5,"label.imei_name")),t.xp6(3),t.Oqu(t.lcZ(6,7,"label.accessory_name")),t.xp6(3),t.Oqu(t.lcZ(9,9,"label.price")),t.xp6(3),t.Oqu(t.lcZ(12,11,"label.quantity")),t.xp6(3),t.Oqu(t.lcZ(15,13,"label.battery_percentage")))}function et(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"p-dropdown",96),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.imeIId=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit,i=t.oxw(2);t.Q6J("options",i.imeis)("ngModel",e.imeIId)("showClear",!0)}}function lt(l,a){if(1&l&&t._uU(0),2&l){const e=t.oxw().$implicit,i=t.oxw(2);t.hij(" ",i.getImeiName(e.imeIId)," ")}}function it(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"p-dropdown",97),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.accessorYId=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit,i=t.oxw(2);t.Q6J("options",i.accessories)("ngModel",e.accessorYId)("showClear",!0)}}function nt(l,a){if(1&l&&t._uU(0),2&l){const e=t.oxw().$implicit,i=t.oxw(2);t.hij(" ",i.getAccessoryName(e.accessorYId)," ")}}function ot(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"p-inputNumber",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.price=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.price)}}function at(l,a){if(1&l&&(t._uU(0),t.ALo(1,"number")),2&l){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.price)," ")}}function st(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"p-inputNumber",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.quantity=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.quantity)}}function ct(l,a){if(1&l&&(t._uU(0),t.ALo(1,"number")),2&l){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.quantity)," ")}}function pt(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"p-inputNumber",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.batteryPercent=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.batteryPercent)}}function rt(l,a){if(1&l&&t._uU(0),2&l){const e=t.oxw().$implicit;t.hij(" ",e.batteryPercent," % ")}}function _t(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"button",98),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.onRowEditInit(n))}),t.qZA()}}function dt(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"button",99),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.onRowEditSave(n))}),t.qZA()}}function mt(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"button",100),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(),o=n.$implicit,p=n.rowIndex,Et=t.oxw(2);return t.KtG(Et.onRowEditCancel(o,p))}),t.qZA()}}function ut(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"tr",89)(1,"td")(2,"p-cellEditor"),t.YNc(3,et,1,3,"ng-template",90),t.YNc(4,lt,1,1,"ng-template",91),t.qZA()(),t.TgZ(5,"td")(6,"p-cellEditor"),t.YNc(7,it,1,3,"ng-template",90),t.YNc(8,nt,1,1,"ng-template",91),t.qZA()(),t.TgZ(9,"td")(10,"p-cellEditor"),t.YNc(11,ot,1,1,"ng-template",90),t.YNc(12,at,2,3,"ng-template",91),t.qZA()(),t.TgZ(13,"td")(14,"p-cellEditor"),t.YNc(15,st,1,1,"ng-template",90),t.YNc(16,ct,2,3,"ng-template",91),t.qZA()(),t.TgZ(17,"td")(18,"p-cellEditor"),t.YNc(19,pt,1,1,"ng-template",90),t.YNc(20,rt,1,1,"ng-template",91),t.qZA()(),t.TgZ(21,"td")(22,"div",92),t.YNc(23,_t,1,0,"button",93),t.YNc(24,dt,1,0,"button",94),t.YNc(25,mt,1,0,"button",95),t.TgZ(26,"button",44),t.NdJ("click",function(){const o=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.deleteBillDetail(o))}),t.qZA()()()()}if(2&l){const i=a.editing;t.Q6J("pEditableRow",a.$implicit),t.xp6(23),t.Q6J("ngIf",!i),t.xp6(1),t.Q6J("ngIf",i),t.xp6(1),t.Q6J("ngIf",i)}}const q=function(){return{"margin-bottom":"2em"}};function gt(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"p-card",61),t.ALo(1,"translate"),t.TgZ(2,"div",62)(3,"div",63)(4,"label",64),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"input",65),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.billCode=n)}),t.qZA()(),t.TgZ(8,"div",63)(9,"label",66),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"p-dropdown",67),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.customeRId=n)}),t.qZA(),t.YNc(13,z,2,0,"small",68),t.qZA(),t.TgZ(14,"div",63)(15,"label",69),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"p-inputNumber",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.totalAmount=n)}),t.qZA()(),t.TgZ(19,"div",71)(20,"label",72),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"p-dropdown",73),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.selectedDeliveryStatus=n)}),t.qZA()(),t.TgZ(24,"div",71)(25,"label",74),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"div",75),t.YNc(29,X,4,5,"div",76),t.qZA()(),t.TgZ(30,"div",77)(31,"label",78),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"input",79),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.description=n)}),t.qZA()()()(),t.TgZ(35,"p-card"),t.YNc(36,W,6,4,"ng-template",8),t.TgZ(37,"p-table",80),t.YNc(38,tt,17,15,"ng-template",8),t.YNc(39,ut,27,4,"ng-template",9),t.qZA()()}if(2&l){const e=t.oxw();t.Akn(t.DdM(37,q)),t.Q6J("header",t.lcZ(1,23,"label.bill_information")),t.xp6(5),t.Oqu(t.lcZ(6,25,"label.bill_code")),t.xp6(2),t.Q6J("ngModel",e.bill.billCode),t.xp6(3),t.Oqu(t.lcZ(11,27,"label.customer_name")),t.xp6(2),t.Q6J("options",e.customers)("ngModel",e.bill.customeRId)("showClear",!0),t.xp6(1),t.Q6J("ngIf",e.submitted&&!e.bill.customeRId),t.xp6(3),t.Oqu(t.lcZ(17,29,"label.total_amount")),t.xp6(2),t.Q6J("ngModel",e.bill.totalAmount),t.xp6(3),t.Oqu(t.lcZ(22,31,"label.delivery_status")),t.xp6(2),t.Q6J("options",e.deliveryStatus)("ngModel",e.selectedDeliveryStatus)("showClear",!0),t.xp6(3),t.Oqu(t.lcZ(27,33,"label.bill_status")),t.xp6(3),t.Q6J("ngForOf",e.billStatus),t.xp6(3),t.Oqu(t.lcZ(33,35,"label.description")),t.xp6(2),t.Q6J("ngModel",e.bill.description),t.xp6(1),t.Akn(t.DdM(38,q)),t.xp6(2),t.Q6J("value",e.billDetails)}}function ht(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"button",101),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.hideDialog())}),t.qZA(),t.TgZ(1,"button",102),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.saveBill())}),t.qZA()}}function bt(l,a){if(1&l&&(t.TgZ(0,"span"),t._uU(1,"Are you sure you want to delete "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"?"),t.qZA()),2&l){const e=t.oxw();t.xp6(3),t.Oqu(e.bill.billCode)}}function ft(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"button",103),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteBillDialog=!1)}),t.qZA(),t.TgZ(1,"button",104),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmDelete())}),t.qZA()}}function Tt(l,a){if(1&l){const e=t.EpF();t.TgZ(0,"button",103),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteBillsDialog=!1)}),t.qZA(),t.TgZ(1,"button",104),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmDeleteSelected())}),t.qZA()}}const Zt=function(){return["billCode","totalAmount","deliveryStatus","billStatus"]},Ct=function(){return[5,10,20]},xt=function(){return{width:"70%"}},Y=function(){return{width:"450px"}};var d=(()=>{return(l=d||(d={}))[l.NOT_YET_PAYMENT=1]="NOT_YET_PAYMENT",l[l.PAYMENT_COMPLETED=2]="PAYMENT_COMPLETED",d;var l})(),c=(()=>{return(l=c||(c={}))[l.NOT_YET_DELIVERY=1]="NOT_YET_DELIVERY",l[l.DELIVERING=2]="DELIVERING",l[l.DELIVERED=3]="DELIVERED",l[l.DELIVERY_FAILED=4]="DELIVERY_FAILED",l[l.DELIVERY_CANCEL=5]="DELIVERY_CANCEL",c;var l})();let Bt=(()=>{class l{constructor(e,i,n,o,p){this.billService=e,this.messageService=i,this.imeiService=n,this.accessoryService=o,this.customerService=p,this.appUtil=g.Z,this.billDialog=!1,this.deleteBillDialog=!1,this.deleteBillsDialog=!1,this.bill={},this.selectedBills=[],this.submitted=!1,this.cols=[],this.rowsPerPageOptions=[5,10,20],this.selectedBillStatus=null,this.billStatus=[{name:"Ch\u01b0a Thanh To\xe1n",key:d.NOT_YET_PAYMENT},{name:"\u0110\xe3 Thanh To\xe1n",key:d.PAYMENT_COMPLETED}],this.selectedDeliveryStatus=null,this.deliveryStatus=[{name:"Ch\u01b0a giao h\xe0ng",code:c.NOT_YET_DELIVERY},{name:"\u0110ang giao h\xe0ng",code:c.DELIVERING},{name:"Giao h\xe0ng th\xe0nh c\xf4ng",code:c.DELIVERED},{name:"Giao h\xe0ng l\u1ed7i",code:c.DELIVERY_FAILED},{name:"\u0110\u01a1n h\xe0ng b\u1ecb h\u1ee7y",code:c.DELIVERY_CANCEL}],this.billDetails=[],this.statuses=[],this.customers=[],this.imeis=[],this.accessories=[],this.loading=!1,this.getParams={page:0,pageSize:5,sortField:"id",isSort:!0,searchText:""},this.lstBill=[],this.bills=[],this.totalRecords=0,this.totalPages=0,this.first=0,this.clonedProducts={}}ngOnInit(){this.getListCustomer(),this.getListImei(),this.getListAccessories(),this.cols=[{field:"accessoryName",header:"Accessory name"},{field:"salePrice",header:"Sale Price"},{field:"description",header:"Description"}],this.statuses=[{label:"In Stock",value:"INSTOCK"},{label:"Low Stock",value:"LOWSTOCK"},{label:"Out of Stock",value:"OUTOFSTOCK"}]}getBillStatusColor(e){switch(e){case d.NOT_YET_PAYMENT:return"info";case d.PAYMENT_COMPLETED:return"success"}return""}getDeliveryStatusColor(e){switch(e){case c.NOT_YET_DELIVERY:return"info";case c.DELIVERING:return"warning";case c.DELIVERED:return"success";case c.DELIVERY_FAILED:case c.DELIVERY_CANCEL:return"error"}return""}getListCustomer(){this.customerService.getAllCustomer().subscribe(e=>{this.customers=e.data})}getListImei(){this.imeiService.getAllImei().subscribe(e=>{this.imeis=e.data})}getCustomerName(e){let i=this.customers.find(n=>n.id===e);return i?i.customerName:""}getImeiName(e){let i=this.imeis.find(n=>n.id===e);return i?i.imeiName:""}getAccessoryName(e){let i=this.accessories.find(n=>n.id===e);return i?i.accessoryName:""}getListAccessories(){this.accessoryService.getAllAccessor().subscribe(e=>{this.accessories=e.data})}getBills(e,i=!1){this.pendingRequest&&this.pendingRequest.unsubscribe(),this.loading=!0,e&&(console.log(e),this.getParams.page=e.first/e.rows,this.getParams.pageSize=e.rows+1,this.getParams.sortField=e.sortField,this.getParams.isSort=1===e.sortOrder),i&&this.billService.getExcelReport(this.getParams).subscribe(n=>{g.Z.scrollToTop(),this.openDownloadFile(n.data,"excel")}),Object.keys(this.getParams).forEach(n=>null==this.getParams[n]&&delete this.getParams[n]),this.pendingRequest=this.billService.getPagingBills(this.getParams).subscribe(n=>{g.Z.scrollToTop(),this.lstBill=n.data,this.totalRecords=n.totalItems||0,this.totalPages=n.totalItems/n.pageSize,console.log(this.lstBill),this.loading=!1})}openDownloadFile(e,i){try{var n=this.billService.getFolderPathDownload(e,i);n&&window.open(n)}catch(o){this.messageService.add({severity:"error",summary:"Error Message",detail:"File invalid"})}}openNew(){this.resetValue(),this.submitted=!1,this.billDialog=!0}deleteSelectedBills(){this.deleteBillsDialog=!0}editBill(e){this.bill=Object.assign({},e),this.selectedBillStatus=this.billStatus.filter(i=>i.key===e.billStatus)[0],this.selectedDeliveryStatus=this.deliveryStatus.filter(i=>i.code===e.deliveryStatus)[0],this.billDetails=e.billDetails||[],this.billDialog=!0}resetValue(){this.selectedDeliveryStatus=null,this.selectedBillStatus=null,this.bill={},this.billDetails=[]}deleteBill(e){this.deleteBillDialog=!0,this.bill=Object.assign({},e)}confirmDeleteSelected(){this.billService.deleteMultipleBill(this.selectedBills.map(e=>e.id)).subscribe(()=>{this.deleteBillsDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Deleted",life:3e3}),this.selectedBills=[],this.getBills()})}confirmDelete(){this.billService.deleteBill(this.bill.id).subscribe(e=>{this.deleteBillDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Deleted",life:3e3}),this.bill={billDetails:[]},this.getBills()})}hideDialog(){this.billDialog=!1,this.submitted=!1,this.bill={},this.getBills()}saveBill(){if(this.bill.billDetails&&this.bill.billDetails.filter(i=>i.imeIId&&i.accessorYId||!i.imeIId&&!i.accessorYId).length>0)return void this.messageService.add({severity:"info",summary:"Information",detail:"Please check again"});this.submitted=!0,this.bill.customeR_ID=this.bill.customeRId,this.bill.billStatus=this.selectedBillStatus.key,this.bill.deliveryStatus=this.selectedDeliveryStatus.code;let e=[];this.billDetails.forEach(i=>{i.bilL_ID=i.bilLId,i.imeI_ID=i.imeIId,i.accessorY_ID=i.accessorYId,e.push(i)}),this.bill.billDetails=e,this.bill.id?this.billService.updateBill(this.bill,this.bill.id).subscribe(i=>{console.log(i),this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Updated",life:3e3}),this.hideDialog()}):(this.bill.id=0,this.billService.createBill(this.bill).subscribe(i=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Created",life:3e3}),this.hideDialog()}))}getDeliveryName(e){let i=this.deliveryStatus.find(n=>n.code===e);return i?i.name:""}getStatusName(e){let i=this.billStatus.find(n=>n.key===e);return i?i.name:""}findIndexById(e){let i=-1;for(let n=0;n<this.bills.length;n++)if(this.bills[n].id===e){i=n;break}return i}onAddBillDetail(){this.billDetails.push({imeIId:0,accessorYId:0,price:0,quantity:1,batteryPercent:0})}onGlobalFilter(e,i){e.filterGlobal(i.target.value,"contains")}exportPdf(){s.e(583).then(s.bind(s,53583)).then(e=>{Promise.all([s.e(583),s.e(983)]).then(s.t.bind(s,12983,23)).then(i=>{const n=new e.default;n.autoTable(this.cols,this.bills),n.save("bill.pdf")})})}exportExcel(){s.e(574).then(s.bind(s,80574)).then(e=>{const n={Sheets:{data:e.utils.json_to_sheet(this.bills)},SheetNames:["data"]},o=e.write(n,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(o,"bills")})}saveAsExcelFile(e,i){const p=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});P.saveAs(p,i+"_export_"+(new Date).getTime()+".xlsx")}onRowEditInit(e){this.clonedProducts[e.id]=Object.assign({},e)}onRowEditSave(e){delete this.clonedProducts[e.id]}onRowEditCancel(e,i){this.billDetails[i]=this.clonedProducts[e.id],delete this.clonedProducts[e.id]}deleteBillDetail(e){this.billDetails=this.billDetails.filter(i=>i!==e)}}return l.\u0275fac=function(e){return new(e||l)(t.Y36(y.C),t.Y36(I.ez),t.Y36(M.s),t.Y36(w.r),t.Y36(S.v))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-bill"]],decls:27,vars:33,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["styleClass","mb-4"],["pTemplate","left"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple",3,"value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","first","lazy","totalRecords","selection","firstChange","onLazyLoad","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[1,"p-fluid",3,"visible","header","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],[1,"my-2"],["pButton","","pRipple","","label","New","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",1,"w-full","sm:w-auto",3,"ngModel","ngModelChange","change"],[2,"width","1rem"],[1,"flex","align-items-center","w-3rem"],[1,"flex","align-items-center","w-8rem"],["pSortableColumn","billCode"],["field","billCode"],["pSortableColumn","totalAmount"],["field","totalAmount"],["pSortableColumn","deliveryStatus"],[1,"flex","align-items-center","w-12rem"],["field","deliveryStatus"],["pSortableColumn","billStatus"],[1,"flex","align-items-center","w-11rem"],["field","billStatus"],[1,"w-2"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],[3,"value","severity",4,"ngIf"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-warning","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[3,"value","severity"],["colspan","12"],[1,"p-3"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["pSortableColumn","imeIId"],["field","imeIId"],["pSortableColumn","accessorYId"],["field","accessorYId"],["pSortableColumn","price"],["field","price"],["pSortableColumn","quantity"],["field","quantity"],["pSortableColumn","batteryPercent"],["field","batteryPercent"],["colspan","6"],[3,"header"],[1,"form-grid","grid"],[1,"field","col-12","md:col-4"],["for","billCode"],["type","text","pInputText","","id","billCode","autofocus","",3,"ngModel","ngModelChange"],["for","customeRId"],["placeholder","Select Customer","optionLabel","customerName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["class","ng-dirty ng-invalid",4,"ngIf"],["for","totalAmount"],[3,"ngModel","ngModelChange"],[1,"field","col-12","md:col-6"],["for","deliveryStatus"],["placeholder","Select delivery status","optionLabel","name",3,"options","ngModel","showClear","ngModelChange"],["for","billStatus"],[1,"flex","gap-8"],["class","field-checkbox",4,"ngFor","ngForOf"],[1,"field","col-12"],["for","description"],["type","text","pInputText","","id","description",3,"ngModel","ngModelChange"],["dataKey","id","editMode","row",3,"value"],[1,"ng-dirty","ng-invalid"],[1,"field-checkbox"],["name","billStatus",3,"inputId","value","ngModel","ngModelChange"],[3,"for"],[1,"flex","justify-content-between","px-4","pt-4"],["pButton","","pRipple","","icon","pi pi-plus",3,"label","click"],[2,"width","20%"],[2,"width","15%"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","icon","pi pi-pencil","class","p-button-rounded p-button-warning","pInitEditableRow","",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","class","p-button-rounded p-button-text p-button-success mr-2",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","class","p-button-rounded p-button-text p-button-danger",3,"click",4,"ngIf"],["placeholder","Select Imei","optionLabel","imeiName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["placeholder","Select Accessory","optionLabel","accessoryName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["pButton","","pRipple","","icon","pi pi-pencil","pInitEditableRow","",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check",1,"p-button-rounded","p-button-text","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"p-toast"),t.TgZ(4,"p-toolbar",3),t.YNc(5,O,3,1,"ng-template",4),t.qZA(),t.TgZ(6,"p-table",5,6),t.NdJ("firstChange",function(o){return i.first=o})("onLazyLoad",function(o){return i.getBills(o)})("selectionChange",function(o){return i.selectedBills=o}),t.YNc(8,F,7,4,"ng-template",7),t.YNc(9,k,31,18,"ng-template",8),t.YNc(10,K,20,10,"ng-template",9),t.YNc(11,V,7,1,"ng-template",10),t.qZA()()()(),t.TgZ(12,"p-dialog",11),t.NdJ("visibleChange",function(o){return i.billDialog=o}),t.ALo(13,"translate"),t.YNc(14,gt,40,39,"ng-template",12),t.YNc(15,ht,2,0,"ng-template",13),t.qZA(),t.TgZ(16,"p-dialog",14),t.NdJ("visibleChange",function(o){return i.deleteBillDialog=o}),t.TgZ(17,"div",15),t._UZ(18,"i",16),t.YNc(19,bt,5,1,"span",17),t.qZA(),t.YNc(20,ft,2,0,"ng-template",13),t.qZA(),t.TgZ(21,"p-dialog",14),t.NdJ("visibleChange",function(o){return i.deleteBillsDialog=o}),t.TgZ(22,"div",15),t._UZ(23,"i",16),t.TgZ(24,"span"),t._uU(25,"Are you sure you want to delete selected accessory?"),t.qZA()(),t.YNc(26,Tt,2,0,"ng-template",13),t.qZA()),2&e&&(t.xp6(6),t.Q6J("value",i.lstBill)("columns",i.cols)("rows",10)("globalFilterFields",t.DdM(28,Zt))("paginator",!0)("rowsPerPageOptions",t.DdM(29,Ct))("showCurrentPageReport",!0)("first",i.first)("lazy",!0)("totalRecords",i.totalRecords)("selection",i.selectedBills)("totalRecords",i.totalRecords),t.xp6(6),t.Akn(t.DdM(30,xt)),t.Q6J("visible",i.billDialog)("header",t.lcZ(13,26,i.appUtil.isEmpty(i.bill)?"label.bill_add":"label.bill_edit"))("modal",!0),t.xp6(4),t.Akn(t.DdM(31,Y)),t.Q6J("visible",i.deleteBillDialog)("modal",!0),t.xp6(3),t.Q6J("ngIf",i.bill),t.xp6(2),t.Akn(t.DdM(32,Y)),t.Q6J("visible",i.deleteBillsDialog)("modal",!0))},dependencies:[m.sg,m.O5,r.iA,I.jx,r.lQ,r.jB,r.YL,r.fz,r.D$,r.Pv,r.U1,r.wT,f.Hq,u.Fj,u.JJ,u.On,T.H,Z.FN,C.o,x.o,B.Lt,A.EU,v.Rn,E.V,D.Z,b.Ct,L.X$,m.JJ],encapsulation:2,data:{animation:[(0,_.X$)("rowExpansionTrigger",[(0,_.SB)("void",(0,_.oB)({transform:"translateX(-10%)",opacity:0})),(0,_.SB)("active",(0,_.oB)({transform:"translateX(0)",opacity:1})),(0,_.eR)("* <=> *",(0,_.jt)("400ms cubic-bezier(0.86, 0, 0.07, 1)"))])]}}),l})(),At=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[N.Bz.forChild([{path:"",component:Bt}]),N.Bz]}),l})(),vt=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({providers:[S.v,w.r,y.C,M.s],imports:[L.aw,m.ez,At,r.U$,R.O,u.u5,f.hJ,T.T,Z.EV,C.V,J.Xt,x.j,U.A,B.kW,A.cc,v.L$,E.S,D.d,b.TX]}),l})()}}]);