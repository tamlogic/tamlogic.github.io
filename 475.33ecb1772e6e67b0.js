"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[475],{98475:(Nt,g,a)=>{a.r(g),a.d(g,{BillModule:()=>It});var h=a(70085),m=a(69808),u=a(93075),r=a(98952),q=a(88205),b=a(40845),f=a(25787),C=a(17773),T=a(44534),J=a(98018),Z=a(31424),U=a(73407),x=a(14036),B=a(49603),v=a(7010),A=a(15315),I=a(51122),E=a(44930),L=a(94327),d=a(41777),t=a(5e3),N=a(84451),y=a(59783),M=a(62162),w=a(373),S=a(21726),D=a(74297);function P(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"div",18)(1,"button",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openNew())}),t.qZA(),t.TgZ(2,"button",20),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteSelectedBills())}),t.qZA()()}if(2&l){const e=t.oxw();t.xp6(2),t.Q6J("disabled",!e.selectedBills||!e.selectedBills.length)}}function F(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"div",21)(1,"h5",22),t._uU(2,"Bills management"),t.qZA(),t.TgZ(3,"span",23),t._UZ(4,"i",24),t.TgZ(5,"input",25),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.getParams.searchText=n)})("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.getBills())}),t.qZA()()()}if(2&l){const e=t.oxw();t.xp6(5),t.Q6J("ngModel",e.getParams.searchText)}}function k(l,s){1&l&&(t.TgZ(0,"tr"),t._UZ(1,"th",26),t.TgZ(2,"th")(3,"div",27),t._uU(4," Bill ID "),t.qZA()(),t.TgZ(5,"th")(6,"div",28),t._uU(7," Customer ID "),t.qZA()(),t.TgZ(8,"th",29)(9,"div",30),t._uU(10," Bill Code "),t._UZ(11,"p-sortIcon",31),t.qZA()(),t.TgZ(12,"th",32)(13,"div",33),t._uU(14," Total Amount "),t._UZ(15,"p-sortIcon",34),t.qZA()(),t.TgZ(16,"th",35)(17,"div",33),t._uU(18," Delivery Status "),t._UZ(19,"p-sortIcon",36),t.qZA()(),t.TgZ(20,"th",37)(21,"div",30),t._uU(22," Bill Status "),t._UZ(23,"p-sortIcon",38),t.qZA()(),t._UZ(24,"th",39),t.qZA())}function O(l,s){if(1&l&&t._UZ(0,"p-badge",45),2&l){const e=t.oxw().$implicit,i=t.oxw();t.Q6J("value",i.getDeliveryName(e.deliveryStatus))("severity",i.getDeliveryStatusColor(e.deliveryStatus))}}function Q(l,s){if(1&l&&t._UZ(0,"p-badge",45),2&l){const e=t.oxw().$implicit,i=t.oxw();t.Q6J("value",i.getStatusName(e.billStatus))("severity",i.getBillStatusColor(e.billStatus))}}function G(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._UZ(2,"button",40),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"td"),t.YNc(13,O,1,2,"p-badge",41),t.qZA(),t.TgZ(14,"td"),t.YNc(15,Q,1,2,"p-badge",41),t.qZA(),t.TgZ(16,"td",39)(17,"div",42)(18,"button",43),t.NdJ("click",function(){const o=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.editBill(o))}),t.qZA(),t.TgZ(19,"button",44),t.NdJ("click",function(){const o=t.CHM(e).$implicit,p=t.oxw();return t.KtG(p.deleteBill(o))}),t.qZA()()()()}if(2&l){const e=s.$implicit,i=s.expanded,n=t.oxw();t.xp6(2),t.Q6J("pRowToggler",e)("icon",i?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(n.getCustomerName(e.customeRId)),t.xp6(2),t.Oqu(e.billCode),t.xp6(2),t.Oqu(t.lcZ(11,8,e.totalAmount)),t.xp6(3),t.Q6J("ngIf",e.deliveryStatus),t.xp6(2),t.Q6J("ngIf",e.billStatus)}}function K(l,s){1&l&&(t.TgZ(0,"tr")(1,"th",50),t._uU(2,"ImeI ID "),t._UZ(3,"p-sortIcon",51),t.qZA(),t.TgZ(4,"th",52),t._uU(5,"Accessory ID "),t._UZ(6,"p-sortIcon",53),t.qZA(),t.TgZ(7,"th",54),t._uU(8,"Price"),t._UZ(9,"p-sortIcon",55),t.qZA(),t.TgZ(10,"th",56),t._uU(11,"Quantity"),t._UZ(12,"p-sortIcon",57),t.qZA(),t.TgZ(13,"th",58),t._uU(14,"Battery Percent"),t._UZ(15,"p-sortIcon",59),t.qZA()())}function $(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"number"),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA()()),2&l){const e=s.$implicit,i=t.oxw(2);t.xp6(2),t.Oqu(i.getImeiName(e.imeIId)),t.xp6(2),t.Oqu(i.getAccessoryName(e.accessorYId)),t.xp6(2),t.Oqu(t.lcZ(7,5,e.price)),t.xp6(3),t.Oqu(t.lcZ(10,7,e.quantity)),t.xp6(3),t.hij("",e.batteryPercent," %")}}function H(l,s){1&l&&(t.TgZ(0,"tr")(1,"td",60),t._uU(2,"There are no order for this bill detail yet."),t.qZA()())}function V(l,s){if(1&l&&(t.TgZ(0,"tr")(1,"td",46)(2,"div",47)(3,"p-table",48),t.YNc(4,K,16,0,"ng-template",8),t.YNc(5,$,13,9,"ng-template",9),t.YNc(6,H,3,0,"ng-template",49),t.qZA()()()()),2&l){const e=s.$implicit;t.xp6(3),t.Q6J("value",e.billDetails)}}function j(l,s){1&l&&(t.TgZ(0,"small",81),t._uU(1,"Customer ID is required."),t.qZA())}function z(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"div",82)(1,"p-radioButton",83),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw(2);return t.KtG(o.selectedBillStatus=n)}),t.qZA(),t.TgZ(2,"label",84),t._uU(3),t.qZA()()}if(2&l){const e=s.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("inputId",e.key)("value",e)("ngModel",i.selectedBillStatus),t.xp6(1),t.Q6J("for",e.key),t.xp6(1),t.Oqu(e.name)}}function X(l,s){1&l&&(t.TgZ(0,"small",81),t._uU(1,"Description is required."),t.qZA())}function W(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"div",85)(1,"h4"),t._uU(2,"Bill Details"),t.qZA(),t.TgZ(3,"div")(4,"button",86),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onAddBillDetail())}),t.qZA()()()}2&l&&(t.xp6(4),t.Q6J("label","Add"))}function tt(l,s){1&l&&(t.TgZ(0,"tr")(1,"th",87),t._uU(2,"Imei Id"),t.qZA(),t.TgZ(3,"th",87),t._uU(4,"Accessory Id"),t.qZA(),t.TgZ(5,"th",88),t._uU(6,"Price"),t.qZA(),t.TgZ(7,"th",88),t._uU(8,"Quantity"),t.qZA(),t.TgZ(9,"th",88),t._uU(10,"Battery percent"),t.qZA(),t._UZ(11,"th",88),t.qZA())}function et(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-dropdown",96),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.imeIId=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit,i=t.oxw(2);t.Q6J("options",i.imeis)("ngModel",e.imeIId)("showClear",!0)}}function lt(l,s){if(1&l&&t._uU(0),2&l){const e=t.oxw().$implicit,i=t.oxw(2);t.hij(" ",i.getImeiName(e.imeIId)," ")}}function it(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-dropdown",97),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.accessorYId=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit,i=t.oxw(2);t.Q6J("options",i.accessories)("ngModel",e.accessorYId)("showClear",!0)}}function nt(l,s){if(1&l&&t._uU(0),2&l){const e=t.oxw().$implicit,i=t.oxw(2);t.hij(" ",i.getAccessoryName(e.accessorYId)," ")}}function ot(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-inputNumber",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.price=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.price)}}function st(l,s){if(1&l&&(t._uU(0),t.ALo(1,"number")),2&l){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.price)," ")}}function at(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-inputNumber",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.quantity=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.quantity)}}function ct(l,s){if(1&l&&(t._uU(0),t.ALo(1,"number")),2&l){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.quantity)," ")}}function pt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-inputNumber",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.batteryPercent=n)}),t.qZA()}if(2&l){const e=t.oxw().$implicit;t.Q6J("ngModel",e.batteryPercent)}}function rt(l,s){if(1&l&&t._uU(0),2&l){const e=t.oxw().$implicit;t.hij(" ",e.batteryPercent," % ")}}function dt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",98),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.onRowEditInit(n))}),t.qZA()}}function _t(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",99),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.onRowEditSave(n))}),t.qZA()}}function mt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",100),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(),o=n.$implicit,p=n.rowIndex,Et=t.oxw(2);return t.KtG(Et.onRowEditCancel(o,p))}),t.qZA()}}function ut(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"tr",89)(1,"td")(2,"p-cellEditor"),t.YNc(3,et,1,3,"ng-template",90),t.YNc(4,lt,1,1,"ng-template",91),t.qZA()(),t.TgZ(5,"td")(6,"p-cellEditor"),t.YNc(7,it,1,3,"ng-template",90),t.YNc(8,nt,1,1,"ng-template",91),t.qZA()(),t.TgZ(9,"td")(10,"p-cellEditor"),t.YNc(11,ot,1,1,"ng-template",90),t.YNc(12,st,2,3,"ng-template",91),t.qZA()(),t.TgZ(13,"td")(14,"p-cellEditor"),t.YNc(15,at,1,1,"ng-template",90),t.YNc(16,ct,2,3,"ng-template",91),t.qZA()(),t.TgZ(17,"td")(18,"p-cellEditor"),t.YNc(19,pt,1,1,"ng-template",90),t.YNc(20,rt,1,1,"ng-template",91),t.qZA()(),t.TgZ(21,"td")(22,"div",92),t.YNc(23,dt,1,0,"button",93),t.YNc(24,_t,1,0,"button",94),t.YNc(25,mt,1,0,"button",95),t.TgZ(26,"button",44),t.NdJ("click",function(){const o=t.CHM(e).$implicit,p=t.oxw(2);return t.KtG(p.deleteBillDetail(o))}),t.qZA()()()()}if(2&l){const i=s.editing;t.Q6J("pEditableRow",s.$implicit),t.xp6(23),t.Q6J("ngIf",!i),t.xp6(1),t.Q6J("ngIf",i),t.xp6(1),t.Q6J("ngIf",i)}}const Y=function(){return{"margin-bottom":"2em"}},gt=function(l){return{"ng-invalid ng-dirty":l}};function ht(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"p-card",61)(1,"div",62)(2,"div",63)(3,"label",64),t._uU(4,"Bill Code"),t.qZA(),t.TgZ(5,"input",65),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.billCode=n)}),t.qZA()(),t.TgZ(6,"div",63)(7,"label",66),t._uU(8,"Customer ID"),t.qZA(),t.TgZ(9,"p-dropdown",67),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.customeRId=n)}),t.qZA(),t.YNc(10,j,2,0,"small",68),t.qZA(),t.TgZ(11,"div",63)(12,"label",69),t._uU(13,"Total Amount"),t.qZA(),t.TgZ(14,"p-inputNumber",70),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.totalAmount=n)}),t.qZA()(),t.TgZ(15,"div",71)(16,"label",72),t._uU(17,"Delivery Status"),t.qZA(),t.TgZ(18,"p-dropdown",73),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.selectedDeliveryStatus=n)}),t.qZA()(),t.TgZ(19,"div",71)(20,"label",74),t._uU(21,"Bill Status"),t.qZA(),t.TgZ(22,"div",75),t.YNc(23,z,4,5,"div",76),t.qZA()(),t.TgZ(24,"div",77)(25,"label",78),t._uU(26,"Description"),t.qZA(),t.TgZ(27,"input",79),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.description=n)}),t.qZA(),t.YNc(28,X,2,0,"small",68),t.qZA()()(),t.TgZ(29,"p-card"),t.YNc(30,W,5,1,"ng-template",8),t.TgZ(31,"p-table",80),t.YNc(32,tt,12,0,"ng-template",8),t.YNc(33,ut,27,4,"ng-template",9),t.qZA()()}if(2&l){const e=t.oxw();t.Akn(t.DdM(18,Y)),t.xp6(5),t.Q6J("ngModel",e.bill.billCode),t.xp6(4),t.Q6J("options",e.customers)("ngModel",e.bill.customeRId)("showClear",!0),t.xp6(1),t.Q6J("ngIf",e.submitted&&!e.bill.customeRId),t.xp6(4),t.Q6J("ngModel",e.bill.totalAmount),t.xp6(4),t.Q6J("options",e.deliveryStatus)("ngModel",e.selectedDeliveryStatus)("showClear",!0),t.xp6(5),t.Q6J("ngForOf",e.billStatus),t.xp6(4),t.Q6J("ngModel",e.bill.description)("ngClass",t.VKq(19,gt,e.submitted&&!e.bill.description)),t.xp6(1),t.Q6J("ngIf",e.submitted&&!e.bill.description),t.xp6(1),t.Akn(t.DdM(21,Y)),t.xp6(2),t.Q6J("value",e.billDetails)}}function bt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",101),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.hideDialog())}),t.qZA(),t.TgZ(1,"button",102),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.saveBill())}),t.qZA()}}function ft(l,s){if(1&l&&(t.TgZ(0,"span"),t._uU(1,"Are you sure you want to delete "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"?"),t.qZA()),2&l){const e=t.oxw();t.xp6(3),t.Oqu(e.bill.billCode)}}function Ct(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",103),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteBillDialog=!1)}),t.qZA(),t.TgZ(1,"button",104),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmDelete())}),t.qZA()}}function Tt(l,s){if(1&l){const e=t.EpF();t.TgZ(0,"button",103),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteBillsDialog=!1)}),t.qZA(),t.TgZ(1,"button",104),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmDeleteSelected())}),t.qZA()}}const Zt=function(){return["billCode","totalAmount","deliveryStatus","billStatus"]},xt=function(){return[5,10,20]},Bt=function(){return{width:"70%"}},R=function(){return{width:"450px"}};var _=(()=>{return(l=_||(_={}))[l.NOT_YET_PAYMENT=1]="NOT_YET_PAYMENT",l[l.PAYMENT_COMPLETED=2]="PAYMENT_COMPLETED",_;var l})(),c=(()=>{return(l=c||(c={}))[l.NOT_YET_DELIVERY=1]="NOT_YET_DELIVERY",l[l.DELIVERING=2]="DELIVERING",l[l.DELIVERED=3]="DELIVERED",l[l.DELIVERY_FAILED=4]="DELIVERY_FAILED",l[l.DELIVERY_CANCEL=5]="DELIVERY_CANCEL",c;var l})();let vt=(()=>{class l{constructor(e,i,n,o,p){this.billService=e,this.messageService=i,this.imeiService=n,this.accessoryService=o,this.customerService=p,this.billDialog=!1,this.deleteBillDialog=!1,this.deleteBillsDialog=!1,this.bill={},this.selectedBills=[],this.submitted=!1,this.cols=[],this.rowsPerPageOptions=[5,10,20],this.selectedBillStatus=null,this.billStatus=[{name:"Ch\u01b0a Thanh To\xe1n",key:_.NOT_YET_PAYMENT},{name:"\u0110\xe3 Thanh To\xe1n",key:_.PAYMENT_COMPLETED}],this.selectedDeliveryStatus=null,this.deliveryStatus=[{name:"Ch\u01b0a giao h\xe0ng",code:c.NOT_YET_DELIVERY},{name:"\u0110ang giao h\xe0ng",code:c.DELIVERING},{name:"Giao h\xe0ng th\xe0nh c\xf4ng",code:c.DELIVERED},{name:"Giao h\xe0ng l\u1ed7i",code:c.DELIVERY_FAILED},{name:"\u0110\u01a1n h\xe0ng b\u1ecb h\u1ee7y",code:c.DELIVERY_CANCEL}],this.billDetails=[],this.statuses=[],this.customers=[],this.imeis=[],this.accessories=[],this.loading=!1,this.getParams={page:0,pageSize:5,sortField:"id",isSort:!0,searchText:""},this.lstBill=[],this.bills=[],this.totalRecords=0,this.totalPages=0,this.first=0,this.clonedProducts={}}ngOnInit(){this.getListCustomer(),this.getListImei(),this.getListAccessories(),this.cols=[{field:"accessoryName",header:"Accessory name"},{field:"salePrice",header:"Sale Price"},{field:"description",header:"Description"}],this.statuses=[{label:"In Stock",value:"INSTOCK"},{label:"Low Stock",value:"LOWSTOCK"},{label:"Out of Stock",value:"OUTOFSTOCK"}]}getBillStatusColor(e){switch(e){case _.NOT_YET_PAYMENT:return"info";case _.PAYMENT_COMPLETED:return"success"}return""}getDeliveryStatusColor(e){switch(e){case c.NOT_YET_DELIVERY:return"info";case c.DELIVERING:return"warning";case c.DELIVERED:return"success";case c.DELIVERY_FAILED:case c.DELIVERY_CANCEL:return"error"}return""}getListCustomer(){this.customerService.getAllCustomer().subscribe(e=>{this.customers=e.data})}getListImei(){this.imeiService.getAllImei().subscribe(e=>{this.imeis=e.data})}getCustomerName(e){let i=this.customers.find(n=>n.id===e);return i?i.customerName:""}getImeiName(e){let i=this.imeis.find(n=>n.id===e);return i?i.imeiName:""}getAccessoryName(e){let i=this.accessories.find(n=>n.id===e);return i?i.accessoryName:""}getListAccessories(){this.accessoryService.getAllAccessor().subscribe(e=>{this.accessories=e.data})}getBills(e,i=!1){this.pendingRequest&&this.pendingRequest.unsubscribe(),this.loading=!0,e&&(console.log(e),this.getParams.page=e.first/e.rows,this.getParams.pageSize=e.rows+1,this.getParams.sortField=e.sortField,this.getParams.isSort=1===e.sortOrder),i&&this.billService.getExcelReport(this.getParams).subscribe(n=>{E.Z.scrollToTop(),this.openDownloadFile(n.data,"excel")}),Object.keys(this.getParams).forEach(n=>null==this.getParams[n]&&delete this.getParams[n]),this.pendingRequest=this.billService.getPagingBills(this.getParams).subscribe(n=>{E.Z.scrollToTop(),this.lstBill=n.data,this.totalRecords=n.totalItems||0,this.totalPages=n.totalItems/n.pageSize,console.log(this.lstBill),this.loading=!1})}openDownloadFile(e,i){try{var n=this.billService.getFolderPathDownload(e,i);n&&window.open(n)}catch(o){this.messageService.add({severity:"error",summary:"Error Message",detail:"File invalid"})}}openNew(){this.resetValue(),this.submitted=!1,this.billDialog=!0}deleteSelectedBills(){this.deleteBillsDialog=!0}editBill(e){this.bill=Object.assign({},e),this.selectedBillStatus=this.billStatus.filter(i=>i.key===e.billStatus)[0],this.selectedDeliveryStatus=this.deliveryStatus.filter(i=>i.code===e.deliveryStatus)[0],this.billDetails=e.billDetails||[],this.billDialog=!0}resetValue(){this.selectedDeliveryStatus=null,this.selectedBillStatus=null,this.bill={},this.billDetails=[]}deleteBill(e){this.deleteBillDialog=!0,this.bill=Object.assign({},e)}confirmDeleteSelected(){this.billService.deleteMultipleBill(this.selectedBills.map(e=>e.id)).subscribe(()=>{this.deleteBillsDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Deleted",life:3e3}),this.selectedBills=[],this.getBills()})}confirmDelete(){this.billService.deleteBill(this.bill.id).subscribe(e=>{this.deleteBillDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Deleted",life:3e3}),this.bill={billDetails:[]},this.getBills()})}hideDialog(){this.billDialog=!1,this.submitted=!1,this.bill={},this.getBills()}saveBill(){var e;this.bill.billDetails&&this.bill.billDetails.filter(i=>i.imeIId&&i.accessorYId||!i.imeIId&&!i.accessorYId).length>0?this.messageService.add({severity:"info",summary:"Information",detail:"Please check again"}):(this.submitted=!0,this.bill.customeR_ID=this.bill.customeRId,this.bill.billStatus=this.selectedBillStatus.key,this.bill.deliveryStatus=this.selectedDeliveryStatus.code,console.log(this.bill.billDetails),null===(e=this.bill.billDetails)||void 0===e||e.forEach(i=>{i.bilL_ID=i.bilLId,i.imeI_ID=i.imeIId,i.accessorY_ID=i.accessorYId}),this.bill.id?this.billService.updateBill(this.bill,this.bill.id).subscribe(i=>{console.log(i),this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Updated",life:3e3}),this.hideDialog()}):(this.bill.id=0,this.billService.createBill(this.bill).subscribe(i=>{console.log(i),this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Created",life:3e3}),this.hideDialog()})))}getDeliveryName(e){let i=this.deliveryStatus.find(n=>n.code===e);return i?i.name:""}getStatusName(e){let i=this.billStatus.find(n=>n.key===e);return i?i.name:""}findIndexById(e){let i=-1;for(let n=0;n<this.bills.length;n++)if(this.bills[n].id===e){i=n;break}return i}onAddBillDetail(){this.billDetails.push({imeIId:0,accessorYId:0,price:0,quantity:1,batteryPercent:0})}onGlobalFilter(e,i){e.filterGlobal(i.target.value,"contains")}exportPdf(){a.e(583).then(a.bind(a,53583)).then(e=>{Promise.all([a.e(583),a.e(983)]).then(a.t.bind(a,12983,23)).then(i=>{const n=new e.default;n.autoTable(this.cols,this.bills),n.save("bill.pdf")})})}exportExcel(){a.e(574).then(a.bind(a,80574)).then(e=>{const n={Sheets:{data:e.utils.json_to_sheet(this.bills)},SheetNames:["data"]},o=e.write(n,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(o,"bills")})}saveAsExcelFile(e,i){const p=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});L.saveAs(p,i+"_export_"+(new Date).getTime()+".xlsx")}onRowEditInit(e){this.clonedProducts[e.id]=Object.assign({},e)}onRowEditSave(e){delete this.clonedProducts[e.id]}onRowEditCancel(e,i){this.billDetails[i]=this.clonedProducts[e.id],delete this.clonedProducts[e.id]}deleteBillDetail(e){this.billDetails=this.billDetails.filter(i=>i!==e)}}return l.\u0275fac=function(e){return new(e||l)(t.Y36(N.C),t.Y36(y.ez),t.Y36(M.s),t.Y36(w.r),t.Y36(S.v))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-bill"]],decls:26,vars:30,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["styleClass","mb-4"],["pTemplate","left"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple",3,"value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","first","lazy","totalRecords","selection","firstChange","onLazyLoad","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["header","Bill Details",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],[1,"my-2"],["pButton","","pRipple","","label","New","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",1,"w-full","sm:w-auto",3,"ngModel","ngModelChange","change"],[2,"width","3rem"],[1,"flex","align-items-center","w-4rem"],[1,"flex","align-items-center","w-6rem"],["pSortableColumn","billCode"],[1,"flex","align-items-center","w-8rem"],["field","billCode"],["pSortableColumn","totalAmount"],[1,"flex","align-items-center","w-9rem"],["field","totalAmount"],["pSortableColumn","deliveryStatus"],["field","deliveryStatus"],["pSortableColumn","billStatus"],["field","billStatus"],[1,"w-2"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],[3,"value","severity",4,"ngIf"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-warning","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],[3,"value","severity"],["colspan","12"],[1,"p-3"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["pSortableColumn","imeIId"],["field","imeIId"],["pSortableColumn","accessorYId"],["field","accessorYId"],["pSortableColumn","price"],["field","price"],["pSortableColumn","quantity"],["field","quantity"],["pSortableColumn","batteryPercent"],["field","batteryPercent"],["colspan","6"],["header","Bill Information"],[1,"form-grid","grid"],[1,"field","col-12","md:col-4"],["for","billCode"],["type","text","pInputText","","id","billCode","autofocus","",3,"ngModel","ngModelChange"],["for","customeRId"],["placeholder","Select Customer","optionLabel","customerName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["class","ng-dirty ng-invalid",4,"ngIf"],["for","totalAmount"],[3,"ngModel","ngModelChange"],[1,"field","col-12","md:col-6"],["for","deliveryStatus"],["placeholder","Select delivery status","optionLabel","name",3,"options","ngModel","showClear","ngModelChange"],["for","billStatus"],[1,"flex","gap-8"],["class","field-checkbox",4,"ngFor","ngForOf"],[1,"field","col-12"],["for","description"],["type","text","pInputText","","id","description","required","",3,"ngModel","ngClass","ngModelChange"],["dataKey","id","editMode","row",3,"value"],[1,"ng-dirty","ng-invalid"],[1,"field-checkbox"],["name","billStatus",3,"inputId","value","ngModel","ngModelChange"],[3,"for"],[1,"flex","justify-content-between","px-4","pt-4"],["pButton","","pRipple","","icon","pi pi-plus",3,"label","click"],[2,"width","20%"],[2,"width","15%"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","icon","pi pi-pencil","class","p-button-rounded p-button-warning","pInitEditableRow","",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","class","p-button-rounded p-button-text p-button-success mr-2",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","class","p-button-rounded p-button-text p-button-danger",3,"click",4,"ngIf"],["placeholder","Select Imei","optionLabel","imeiName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["placeholder","Select Accessory","optionLabel","accessoryName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["pButton","","pRipple","","icon","pi pi-pencil","pInitEditableRow","",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check",1,"p-button-rounded","p-button-text","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"p-toast"),t.TgZ(4,"p-toolbar",3),t.YNc(5,P,3,1,"ng-template",4),t.qZA(),t.TgZ(6,"p-table",5,6),t.NdJ("firstChange",function(o){return i.first=o})("onLazyLoad",function(o){return i.getBills(o)})("selectionChange",function(o){return i.selectedBills=o}),t.YNc(8,F,6,1,"ng-template",7),t.YNc(9,k,25,0,"ng-template",8),t.YNc(10,G,20,10,"ng-template",9),t.YNc(11,V,7,1,"ng-template",10),t.qZA()()()(),t.TgZ(12,"p-dialog",11),t.NdJ("visibleChange",function(o){return i.billDialog=o}),t.YNc(13,ht,34,22,"ng-template",12),t.YNc(14,bt,2,0,"ng-template",13),t.qZA(),t.TgZ(15,"p-dialog",14),t.NdJ("visibleChange",function(o){return i.deleteBillDialog=o}),t.TgZ(16,"div",15),t._UZ(17,"i",16),t.YNc(18,ft,5,1,"span",17),t.qZA(),t.YNc(19,Ct,2,0,"ng-template",13),t.qZA(),t.TgZ(20,"p-dialog",14),t.NdJ("visibleChange",function(o){return i.deleteBillsDialog=o}),t.TgZ(21,"div",15),t._UZ(22,"i",16),t.TgZ(23,"span"),t._uU(24,"Are you sure you want to delete selected accessory?"),t.qZA()(),t.YNc(25,Tt,2,0,"ng-template",13),t.qZA()),2&e&&(t.xp6(6),t.Q6J("value",i.lstBill)("columns",i.cols)("rows",10)("globalFilterFields",t.DdM(25,Zt))("paginator",!0)("rowsPerPageOptions",t.DdM(26,xt))("showCurrentPageReport",!0)("first",i.first)("lazy",!0)("totalRecords",i.totalRecords)("selection",i.selectedBills)("totalRecords",i.totalRecords),t.xp6(6),t.Akn(t.DdM(27,Bt)),t.Q6J("visible",i.billDialog)("modal",!0),t.xp6(3),t.Akn(t.DdM(28,R)),t.Q6J("visible",i.deleteBillDialog)("modal",!0),t.xp6(3),t.Q6J("ngIf",i.bill),t.xp6(2),t.Akn(t.DdM(29,R)),t.Q6J("visible",i.deleteBillsDialog)("modal",!0))},dependencies:[m.mk,m.sg,m.O5,r.iA,y.jx,r.lQ,r.jB,r.YL,r.fz,r.D$,r.Pv,r.U1,r.wT,b.Hq,u.Fj,u.JJ,u.Q7,u.On,f.H,C.FN,T.o,Z.o,x.Lt,B.EU,v.Rn,A.V,D.Z,h.Ct,m.JJ],encapsulation:2,data:{animation:[(0,d.X$)("rowExpansionTrigger",[(0,d.SB)("void",(0,d.oB)({transform:"translateX(-10%)",opacity:0})),(0,d.SB)("active",(0,d.oB)({transform:"translateX(0)",opacity:1})),(0,d.eR)("* <=> *",(0,d.jt)("400ms cubic-bezier(0.86, 0, 0.07, 1)"))])]}}),l})(),At=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[I.Bz.forChild([{path:"",component:vt}]),I.Bz]}),l})(),It=(()=>{class l{}return l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({providers:[S.v,w.r,N.C,M.s],imports:[m.ez,At,r.U$,q.O,u.u5,b.hJ,f.T,C.EV,T.V,J.Xt,Z.j,U.A,x.kW,B.cc,v.L$,A.S,D.d,h.TX]}),l})()}}]);