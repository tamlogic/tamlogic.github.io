(self.webpackChunksakai=self.webpackChunksakai||[]).push([[5094],{15094:(I,A,a)=>{"use strict";a.d(A,{$T:()=>h,DK:()=>E,Su:()=>Zt});var f=a(44930),g=a(94327),m=a(41777),t=a(5e3),T=a(84451),u=a(59783),Z=a(62162),b=a(373),p=a(21726),o=a(50330),_=a(69808),c=a(98952),d=a(40845),B=a(93075),y=a(25787),M=a(17773),w=a(44534),D=a(31424),x=a(14036),P=a(49603),N=a(7010),U=a(15315),O=a(74297),S=a(70085),Y=a(27232);function q(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.deleteSelectedBills())}),t.qZA()}}function J(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",20)(1,"button",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openNew())}),t.qZA(),t.YNc(2,q,1,0,"button",22),t.qZA()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.selectedBills&&e.selectedBills.length>0)}}function K(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",24)(1,"h5",25),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",26),t._UZ(5,"i",27),t.TgZ(6,"input",28),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.getParams.searchText=i)})("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.getBills())}),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,2,"label.bill_management")," "),t.xp6(4),t.Q6J("ngModel",e.getParams.searchText)}}function F(n,r){1&n&&(t.TgZ(0,"tr"),t._UZ(1,"th",29),t.TgZ(2,"th")(3,"div",30),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"th")(7,"div",31),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"th",32)(11,"div",31),t._uU(12),t.ALo(13,"translate"),t._UZ(14,"p-sortIcon",33),t.qZA()(),t.TgZ(15,"th",34)(16,"div",31),t._uU(17),t.ALo(18,"translate"),t._UZ(19,"p-sortIcon",35),t.qZA()(),t.TgZ(20,"th",36)(21,"div",37),t._uU(22),t.ALo(23,"translate"),t._UZ(24,"p-sortIcon",38),t.qZA()(),t.TgZ(25,"th",39)(26,"div",40),t._uU(27),t.ALo(28,"translate"),t._UZ(29,"p-sortIcon",41),t.qZA()()()),2&n&&(t.xp6(4),t.hij(" ",t.lcZ(5,6,"label.bill_id")," "),t.xp6(4),t.hij(" ",t.lcZ(9,8,"label.customer_name")," "),t.xp6(4),t.hij(" ",t.lcZ(13,10,"label.bill_code")," "),t.xp6(5),t.hij(" ",t.lcZ(18,12,"label.total_amount")," "),t.xp6(5),t.hij(" ",t.lcZ(23,14,"label.delivery_status")," "),t.xp6(5),t.hij(" ",t.lcZ(28,16,"label.bill_status")," "))}function j(n,r){if(1&n&&t._UZ(0,"p-badge",45),2&n){const e=t.oxw().$implicit,l=t.oxw();t.Q6J("value",l.getDeliveryName(e.deliveryStatus))("severity",l.getDeliveryStatusColor(e.deliveryStatus))}}function k(n,r){if(1&n&&t._UZ(0,"p-badge",45),2&n){const e=t.oxw().$implicit,l=t.oxw();t.Q6J("value",l.getStatusName(e.billStatus))("severity",l.getBillStatusColor(e.billStatus))}}function $(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",42),t.NdJ("click",function(){const s=t.CHM(e).$implicit,C=t.oxw();return t.KtG(C.editBill(s))}),t.TgZ(1,"td"),t._UZ(2,"button",43),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"td"),t.YNc(13,j,1,2,"p-badge",44),t.qZA(),t.TgZ(14,"td"),t.YNc(15,k,1,2,"p-badge",44),t.qZA()()}if(2&n){const e=r.$implicit,l=r.expanded,i=t.oxw();t.Q6J("pContextMenuRow",e),t.xp6(2),t.Q6J("pRowToggler",e)("icon",l?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(i.getCustomerName(e.customeRId)),t.xp6(2),t.Oqu(e.billCode),t.xp6(2),t.Oqu(t.lcZ(11,9,e.totalAmount)),t.xp6(3),t.Q6J("ngIf",e.deliveryStatus),t.xp6(2),t.Q6J("ngIf",e.billStatus)}}function G(n,r){1&n&&(t.TgZ(0,"tr")(1,"th",50),t._uU(2," ImeI ID "),t._UZ(3,"p-sortIcon",51),t.qZA(),t.TgZ(4,"th",52),t._uU(5," Accessory ID "),t._UZ(6,"p-sortIcon",53),t.qZA(),t.TgZ(7,"th",54),t._uU(8," Price"),t._UZ(9,"p-sortIcon",55),t.qZA(),t.TgZ(10,"th",56),t._uU(11," Quantity"),t._UZ(12,"p-sortIcon",57),t.qZA(),t.TgZ(13,"th",58),t._uU(14," Battery Percent"),t._UZ(15,"p-sortIcon",59),t.qZA()())}function Q(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"number"),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA()()),2&n){const e=r.$implicit,l=t.oxw(2);t.xp6(2),t.hij(" ",l.getImeiName(e.imeIId)," "),t.xp6(2),t.hij(" ",l.getAccessoryName(e.accessorYId)," "),t.xp6(2),t.hij(" ",t.lcZ(7,5,e.price)," "),t.xp6(3),t.hij(" ",t.lcZ(10,7,e.quantity)," "),t.xp6(3),t.hij(" ",e.batteryPercent," % ")}}function W(n,r){1&n&&(t.TgZ(0,"tr")(1,"td",60),t._uU(2," There are no order for this bill detail yet. "),t.qZA()())}function H(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td",46)(2,"div",47)(3,"p-table",48),t.YNc(4,G,16,0,"ng-template",10),t.YNc(5,Q,13,9,"ng-template",11),t.YNc(6,W,3,0,"ng-template",49),t.qZA()()()()),2&n){const e=r.$implicit;t.xp6(3),t.Q6J("value",e.billDetails)}}function V(n,r){1&n&&(t.TgZ(0,"small",80),t._uU(1,"Customer ID is required."),t.qZA())}function z(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",81)(1,"p-radioButton",82),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw(2);return t.KtG(s.selectedBillStatus=i)}),t.qZA(),t.TgZ(2,"label",83),t._uU(3),t.qZA()()}if(2&n){const e=r.$implicit,l=t.oxw(2);t.xp6(1),t.Q6J("inputId",e.key)("value",e)("ngModel",l.selectedBillStatus),t.xp6(1),t.Q6J("for",e.key),t.xp6(1),t.Oqu(e.name)}}function X(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",84)(1,"h4"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div")(5,"button",85),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onAddBillDetail())}),t.qZA()()()}2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,2,"label.bill_detail_management")),t.xp6(3),t.Q6J("label","Add"))}function tt(n,r){1&n&&(t.TgZ(0,"tr")(1,"th",86),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"th",86),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"th",87),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"th",87),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"th",87),t._uU(14),t.ALo(15,"translate"),t.qZA(),t._UZ(16,"th",87),t.qZA()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,5,"label.imei_name")," "),t.xp6(3),t.hij(" ",t.lcZ(6,7,"label.accessory_name")," "),t.xp6(3),t.hij(" ",t.lcZ(9,9,"label.price")," "),t.xp6(3),t.hij(" ",t.lcZ(12,11,"label.quantity")," "),t.xp6(3),t.hij(" ",t.lcZ(15,13,"label.battery_percentage")," "))}function et(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-dropdown",96),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.imeIId=i)}),t.qZA()}if(2&n){const e=t.oxw().$implicit,l=t.oxw(2);t.Q6J("options",l.imeis)("ngModel",e.imeIId)("showClear",!0)}}function lt(n,r){if(1&n&&t._uU(0),2&n){const e=t.oxw().$implicit,l=t.oxw(2);t.hij(" ",l.getImeiName(e.imeIId)," ")}}function nt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-dropdown",97),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.accessorYId=i)}),t.qZA()}if(2&n){const e=t.oxw().$implicit,l=t.oxw(2);t.Q6J("options",l.accessories)("ngModel",e.accessorYId)("showClear",!0)}}function it(n,r){if(1&n&&t._uU(0),2&n){const e=t.oxw().$implicit,l=t.oxw(2);t.hij(" ",l.getAccessoryName(e.accessorYId)," ")}}function ot(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-inputNumber",98),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.price=i)}),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.Q6J("ngModel",e.price)}}function st(n,r){if(1&n&&(t._uU(0),t.ALo(1,"number")),2&n){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.price)," ")}}function at(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-inputNumber",98),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.quantity=i)}),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.Q6J("ngModel",e.quantity)}}function ct(n,r){if(1&n&&(t._uU(0),t.ALo(1,"number")),2&n){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.quantity)," ")}}function rt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-inputNumber",98),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw().$implicit;return t.KtG(s.batteryPercent=i)}),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.Q6J("ngModel",e.batteryPercent)}}function _t(n,r){if(1&n&&t._uU(0),2&n){const e=t.oxw().$implicit;t.hij(" ",e.batteryPercent," % ")}}function pt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",99),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.onRowEditInit(i))}),t.qZA()}}function ut(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",100),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,s=t.oxw(2);return t.KtG(s.onRowEditSave(i))}),t.qZA()}}function dt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",101),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(),s=i.$implicit,C=i.rowIndex,At=t.oxw(2);return t.KtG(At.onRowEditCancel(s,C))}),t.qZA()}}function mt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",88)(1,"td")(2,"p-cellEditor"),t.YNc(3,et,1,3,"ng-template",89),t.YNc(4,lt,1,1,"ng-template",90),t.qZA()(),t.TgZ(5,"td")(6,"p-cellEditor"),t.YNc(7,nt,1,3,"ng-template",89),t.YNc(8,it,1,1,"ng-template",90),t.qZA()(),t.TgZ(9,"td")(10,"p-cellEditor"),t.YNc(11,ot,1,1,"ng-template",89),t.YNc(12,st,2,3,"ng-template",90),t.qZA()(),t.TgZ(13,"td")(14,"p-cellEditor"),t.YNc(15,at,1,1,"ng-template",89),t.YNc(16,ct,2,3,"ng-template",90),t.qZA()(),t.TgZ(17,"td")(18,"p-cellEditor"),t.YNc(19,rt,1,1,"ng-template",89),t.YNc(20,_t,1,1,"ng-template",90),t.qZA()(),t.TgZ(21,"td")(22,"div",91),t.YNc(23,pt,1,0,"button",92),t.YNc(24,ut,1,0,"button",93),t.YNc(25,dt,1,0,"button",94),t.TgZ(26,"button",95),t.NdJ("click",function(){const s=t.CHM(e).$implicit,C=t.oxw(2);return t.KtG(C.deleteBillDetail(s))}),t.qZA()()()()}if(2&n){const l=r.editing;t.Q6J("pEditableRow",r.$implicit),t.xp6(23),t.Q6J("ngIf",!l),t.xp6(1),t.Q6J("ngIf",l),t.xp6(1),t.Q6J("ngIf",l)}}const L=function(){return{"margin-bottom":"2em"}};function gt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p-card",61),t.ALo(1,"translate"),t.TgZ(2,"div",62)(3,"div",63)(4,"label",64),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"input",65),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.bill.billCode=i)}),t.qZA()(),t.TgZ(8,"div",63)(9,"label",66),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"p-dropdown",67),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.bill.customeRId=i)}),t.qZA(),t.YNc(13,V,2,0,"small",68),t.qZA(),t.TgZ(14,"div",63)(15,"label",69),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"p-inputNumber",70),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.bill.totalAmount=i)}),t.qZA()(),t.TgZ(19,"div",71)(20,"label",72),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"p-dropdown",73),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.selectedDeliveryStatus=i)}),t.qZA()(),t.TgZ(24,"div",71)(25,"label"),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"div",74),t.YNc(29,z,4,5,"div",75),t.qZA()(),t.TgZ(30,"div",76)(31,"label",77),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"input",78),t.NdJ("ngModelChange",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.bill.description=i)}),t.qZA()()()(),t.TgZ(35,"p-card"),t.YNc(36,X,6,4,"ng-template",10),t.TgZ(37,"p-table",79),t.YNc(38,tt,17,15,"ng-template",10),t.YNc(39,mt,27,4,"ng-template",11),t.qZA()()}if(2&n){const e=t.oxw();t.Akn(t.DdM(37,L)),t.Q6J("header",t.lcZ(1,23,"label.bill_information")),t.xp6(5),t.Oqu(t.lcZ(6,25,"label.bill_code")),t.xp6(2),t.Q6J("ngModel",e.bill.billCode),t.xp6(3),t.Oqu(t.lcZ(11,27,"label.customer_name")),t.xp6(2),t.Q6J("options",e.customers)("ngModel",e.bill.customeRId)("showClear",!0),t.xp6(1),t.Q6J("ngIf",e.submitted&&!e.bill.customeRId),t.xp6(3),t.Oqu(t.lcZ(17,29,"label.total_amount")),t.xp6(2),t.Q6J("ngModel",e.bill.totalAmount),t.xp6(3),t.Oqu(t.lcZ(22,31,"label.delivery_status")),t.xp6(2),t.Q6J("options",e.deliveryStatus)("ngModel",e.selectedDeliveryStatus)("showClear",!0),t.xp6(3),t.Oqu(t.lcZ(27,33,"label.bill_status")),t.xp6(3),t.Q6J("ngForOf",e.billStatus),t.xp6(3),t.Oqu(t.lcZ(33,35,"label.description")),t.xp6(2),t.Q6J("ngModel",e.bill.description),t.xp6(1),t.Akn(t.DdM(38,L)),t.xp6(2),t.Q6J("value",e.billDetails)}}function ht(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",102),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.hideDialog())}),t.qZA(),t.TgZ(1,"button",103),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.saveBill())}),t.qZA()}}function bt(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1,"Are you sure you want to delete "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"?"),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Oqu(e.bill.billCode)}}function ft(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",104),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteBillDialog=!1)}),t.qZA(),t.TgZ(1,"button",105),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.confirmDelete())}),t.qZA()}}function Ct(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",104),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteBillsDialog=!1)}),t.qZA(),t.TgZ(1,"button",105),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.confirmDeleteSelected())}),t.qZA()}}const Tt=function(){return["billCode","totalAmount","deliveryStatus","billStatus"]},Et=function(){return[5,10,20]},xt=function(){return{width:"70%"}},R=function(){return{width:"450px"}};var E=(()=>{return(n=E||(E={}))[n.NOT_YET_PAYMENT=1]="NOT_YET_PAYMENT",n[n.PAYMENT_COMPLETED=2]="PAYMENT_COMPLETED",E;var n})(),h=(()=>{return(n=h||(h={}))[n.NOT_YET_DELIVERY=1]="NOT_YET_DELIVERY",n[n.DELIVERING=2]="DELIVERING",n[n.DELIVERED=3]="DELIVERED",n[n.DELIVERY_FAILED=4]="DELIVERY_FAILED",n[n.DELIVERY_CANCEL=5]="DELIVERY_CANCEL",h;var n})();let Zt=(()=>{class n{constructor(e,l,i,s,C){this.billService=e,this.messageService=l,this.imeiService=i,this.accessoryService=s,this.customerService=C,this.appUtil=f.Z,this.billDialog=!1,this.deleteBillDialog=!1,this.deleteBillsDialog=!1,this.bill={},this.selectedBills=[],this.selectedBill={},this.items=[],this.submitted=!1,this.cols=[],this.rowsPerPageOptions=[5,10,20],this.selectedBillStatus=null,this.billStatus=[{name:"Ch\u01b0a Thanh To\xe1n",key:E.NOT_YET_PAYMENT},{name:"\u0110\xe3 Thanh To\xe1n",key:E.PAYMENT_COMPLETED}],this.selectedDeliveryStatus=null,this.deliveryStatus=[{name:"Ch\u01b0a giao h\xe0ng",code:h.NOT_YET_DELIVERY},{name:"\u0110ang giao h\xe0ng",code:h.DELIVERING},{name:"Giao h\xe0ng th\xe0nh c\xf4ng",code:h.DELIVERED},{name:"Giao h\xe0ng l\u1ed7i",code:h.DELIVERY_FAILED},{name:"\u0110\u01a1n h\xe0ng b\u1ecb h\u1ee7y",code:h.DELIVERY_CANCEL}],this.billDetails=[],this.statuses=[],this.customers=[],this.imeis=[],this.accessories=[],this.loading=!1,this.getParams={page:0,pageSize:5,sortField:"id",isSort:!0,searchText:""},this.lstBill=[],this.bills=[],this.totalRecords=0,this.totalPages=0,this.first=0,this.clonedProducts={}}ngOnInit(){this.getListCustomer(),this.getListImei(),this.getListAccessories(),this.cols=[{field:"accessoryName",header:"Accessory name"},{field:"salePrice",header:"Sale Price"},{field:"description",header:"Description"}],this.statuses=[{label:"In Stock",value:"INSTOCK"},{label:"Low Stock",value:"LOWSTOCK"},{label:"Out of Stock",value:"OUTOFSTOCK"}],this.items=[{label:"View",icon:"pi pi-fw pi-search",command:()=>{this.editBill(this.selectedBill)}},{label:"Delete",icon:"pi pi-fw pi-times",command:()=>{this.deleteBill(this.selectedBill)}}]}getBillStatusColor(e){switch(e){case E.NOT_YET_PAYMENT:return"info";case E.PAYMENT_COMPLETED:return"success"}return""}getDeliveryStatusColor(e){switch(e){case h.NOT_YET_DELIVERY:return"info";case h.DELIVERING:return"warning";case h.DELIVERED:return"success";case h.DELIVERY_FAILED:case h.DELIVERY_CANCEL:return"error"}return""}getListCustomer(){this.customerService.getAllCustomer().subscribe(e=>{this.customers=e.data})}getListImei(){this.imeiService.getAllImei().subscribe(e=>{this.imeis=e.data})}getCustomerName(e){const l=this.customers.find(i=>i.id===e);return l?l.customerName:""}getImeiName(e){const l=this.imeis.find(i=>i.id===e);return l?l.imeiName:""}getAccessoryName(e){const l=this.accessories.find(i=>i.id===e);return l?l.accessoryName:""}getListAccessories(){this.accessoryService.getAllAccessor().subscribe(e=>{this.accessories=e.data})}getBills(e,l=!1){this.pendingRequest&&this.pendingRequest.unsubscribe(),this.loading=!0,e&&(console.log(e),this.getParams.page=e.first/e.rows,this.getParams.pageSize=e.rows+1,this.getParams.sortField=e.sortField,this.getParams.isSort=1===e.sortOrder),l&&this.billService.getExcelReport(this.getParams).subscribe(i=>{f.Z.scrollToTop(),this.openDownloadFile(i.data,"excel")}),Object.keys(this.getParams).forEach(i=>null==this.getParams[i]&&delete this.getParams[i]),this.pendingRequest=this.billService.getPagingBills(this.getParams).subscribe(i=>{f.Z.scrollToTop(),this.lstBill=i.data,this.totalRecords=i.totalItems||0,this.totalPages=i.totalItems/i.pageSize,console.log(this.lstBill),this.loading=!1})}openDownloadFile(e,l){try{const i=this.billService.getFolderPathDownload(e,l);i&&window.open(i)}catch(i){this.messageService.add({severity:"error",summary:"Error Message",detail:"File invalid"})}}openNew(){this.resetValue(),this.submitted=!1,this.billDialog=!0}deleteSelectedBills(){this.deleteBillsDialog=!0}editBill(e){this.bill=Object.assign({},e),this.selectedBillStatus=this.billStatus.filter(l=>l.key===e.billStatus)[0],this.selectedDeliveryStatus=this.deliveryStatus.filter(l=>l.code===e.deliveryStatus)[0],this.billDetails=e.billDetails||[],this.billDialog=!0}resetValue(){this.selectedDeliveryStatus=null,this.selectedBillStatus=null,this.bill={billCode:"HD-"+this.appUtil.createId(7)},this.billDetails=[]}deleteBill(e){this.deleteBillDialog=!0,this.bill=Object.assign({},e)}confirmDeleteSelected(){this.billService.deleteMultipleBill(this.selectedBills.map(e=>e.id)).subscribe(()=>{this.deleteBillsDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Deleted",life:3e3}),this.selectedBills=[],this.getBills()})}confirmDelete(){this.billService.deleteBill(this.bill.id).subscribe(e=>{this.deleteBillDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Deleted",life:3e3}),this.bill={billDetails:[]},this.getBills()})}hideDialog(){this.billDialog=!1,this.submitted=!1,this.bill={},this.getBills()}saveBill(){if(this.bill.billDetails&&this.bill.billDetails.filter(l=>l.imeIId&&l.accessorYId||!l.imeIId&&!l.accessorYId).length>0)return void this.messageService.add({severity:"info",summary:"Information",detail:"Please check again"});this.submitted=!0,this.bill.customeR_ID=this.bill.customeRId,this.bill.billStatus=this.selectedBillStatus.key,this.bill.deliveryStatus=this.selectedDeliveryStatus.code;const e=[];this.billDetails.forEach(l=>{l.bilL_ID=l.bilLId,l.imeI_ID=l.imeIId,l.accessorY_ID=l.accessorYId,e.push(l)}),this.bill.billDetails=e,this.bill.id?this.billService.updateBill(this.bill,this.bill.id).subscribe(l=>{console.log(l),this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Updated",life:3e3}),this.hideDialog()}):(this.bill.id=0,this.billService.createBill(this.bill).subscribe(l=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Created",life:3e3}),this.hideDialog()}))}getDeliveryName(e){const l=this.deliveryStatus.find(i=>i.code===e);return l?l.name:""}getStatusName(e){const l=this.billStatus.find(i=>i.key===e);return l?l.name:""}findIndexById(e){let l=-1;for(let i=0;i<this.bills.length;i++)if(this.bills[i].id===e){l=i;break}return l}onAddBillDetail(){this.billDetails.push({imeIId:0,accessorYId:0,price:0,quantity:1,batteryPercent:0})}onGlobalFilter(e,l){e.filterGlobal(l.target.value,"contains")}exportPdf(){a.e(3583).then(a.bind(a,53583)).then(e=>{Promise.all([a.e(3583),a.e(2983)]).then(a.t.bind(a,12983,23)).then(l=>{const i=new e.default;i.autoTable(this.cols,this.bills),i.save("bill.pdf")})})}exportExcel(){a.e(574).then(a.bind(a,80574)).then(e=>{const i={Sheets:{data:e.utils.json_to_sheet(this.bills)},SheetNames:["data"]},s=e.write(i,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(s,"bills")})}saveAsExcelFile(e,l){const C=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});g.saveAs(C,l+"_export_"+(new Date).getTime()+".xlsx")}onRowEditInit(e){this.clonedProducts[e.id]=Object.assign({},e)}onRowEditSave(e){delete this.clonedProducts[e.id]}onRowEditCancel(e,l){this.billDetails[l]=this.clonedProducts[e.id],delete this.clonedProducts[e.id]}deleteBillDetail(e){this.billDetails=this.billDetails.filter(l=>l!==e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(T.C),t.Y36(u.ez),t.Y36(Z.s),t.Y36(b.r),t.Y36(p.v))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-bill"]],decls:29,vars:36,consts:[[3,"model"],["cm",""],[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["styleClass","mb-4"],["pTemplate","left"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple",3,"value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","first","lazy","totalRecords","selection","contextMenu","contextMenuSelection","firstChange","onLazyLoad","selectionChange","contextMenuSelectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[1,"p-fluid",3,"visible","header","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],[1,"my-2"],["pButton","","pRipple","","label","New","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash","class","p-button-danger",3,"click",4,"ngIf"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger",3,"click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",1,"w-full","sm:w-auto",3,"ngModel","ngModelChange","change"],[2,"width","1rem"],[1,"flex","align-items-center","w-3rem"],[1,"flex","align-items-center","w-8rem"],["pSortableColumn","billCode"],["field","billCode"],["pSortableColumn","totalAmount"],["field","totalAmount"],["pSortableColumn","deliveryStatus"],[1,"flex","align-items-center","w-12rem"],["field","deliveryStatus"],["pSortableColumn","billStatus"],[1,"flex","align-items-center","w-11rem"],["field","billStatus"],[1,"cursor-pointer",3,"pContextMenuRow","click"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],[3,"value","severity",4,"ngIf"],[3,"value","severity"],["colspan","12"],[1,"p-3"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["pSortableColumn","imeIId"],["field","imeIId"],["pSortableColumn","accessorYId"],["field","accessorYId"],["pSortableColumn","price"],["field","price"],["pSortableColumn","quantity"],["field","quantity"],["pSortableColumn","batteryPercent"],["field","batteryPercent"],["colspan","6"],[3,"header"],[1,"form-grid","grid"],[1,"field","col-12","md:col-4"],["for","billCode"],["type","text","pInputText","","id","billCode","autofocus","",3,"ngModel","ngModelChange"],["for","customeRId"],["id","customeRId","placeholder","Select Customer","optionLabel","customerName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["class","ng-dirty ng-invalid",4,"ngIf"],["for","totalAmount"],["id","totalAmount",3,"ngModel","ngModelChange"],[1,"field","col-12","md:col-6"],["for","deliveryStatus"],["id","deliveryStatus","placeholder","Select delivery status","optionLabel","name",3,"options","ngModel","showClear","ngModelChange"],[1,"flex","gap-8"],["class","field-checkbox",4,"ngFor","ngForOf"],[1,"field","col-12"],["for","description"],["type","text","pInputText","","id","description",3,"ngModel","ngModelChange"],["dataKey","id","editMode","row",3,"value"],[1,"ng-dirty","ng-invalid"],[1,"field-checkbox"],["name","billStatus",3,"inputId","value","ngModel","ngModelChange"],[3,"for"],[1,"flex","justify-content-between","px-4","pt-4"],["pButton","","pRipple","","icon","pi pi-plus",3,"label","click"],[2,"width","20%"],[2,"width","15%"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","icon","pi pi-pencil","class","p-button-rounded p-button-warning","pInitEditableRow","",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","class","p-button-rounded p-button-text p-button-success mr-2",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","class","p-button-rounded p-button-text p-button-danger",3,"click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],["placeholder","Select Imei","optionLabel","imeiName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["placeholder","Select Accessory","optionLabel","accessoryName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],[3,"ngModel","ngModelChange"],["pButton","","pRipple","","icon","pi pi-pencil","pInitEditableRow","",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check",1,"p-button-rounded","p-button-text","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"]],template:function(e,l){if(1&e&&(t._UZ(0,"p-contextMenu",0,1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4),t._UZ(5,"p-toast"),t.TgZ(6,"p-toolbar",5),t.YNc(7,J,3,1,"ng-template",6),t.qZA(),t.TgZ(8,"p-table",7,8),t.NdJ("firstChange",function(s){return l.first=s})("onLazyLoad",function(s){return l.getBills(s)})("selectionChange",function(s){return l.selectedBills=s})("contextMenuSelectionChange",function(s){return l.selectedBill=s}),t.YNc(10,K,7,4,"ng-template",9),t.YNc(11,F,30,18,"ng-template",10),t.YNc(12,$,16,11,"ng-template",11),t.YNc(13,H,7,1,"ng-template",12),t.qZA()()()(),t.TgZ(14,"p-dialog",13),t.NdJ("visibleChange",function(s){return l.billDialog=s}),t.ALo(15,"translate"),t.YNc(16,gt,40,39,"ng-template",14),t.YNc(17,ht,2,0,"ng-template",15),t.qZA(),t.TgZ(18,"p-dialog",16),t.NdJ("visibleChange",function(s){return l.deleteBillDialog=s}),t.TgZ(19,"div",17),t._UZ(20,"i",18),t.YNc(21,bt,5,1,"span",19),t.qZA(),t.YNc(22,ft,2,0,"ng-template",15),t.qZA(),t.TgZ(23,"p-dialog",16),t.NdJ("visibleChange",function(s){return l.deleteBillsDialog=s}),t.TgZ(24,"div",17),t._UZ(25,"i",18),t.TgZ(26,"span"),t._uU(27,"Are you sure you want to delete selected accessory?"),t.qZA()(),t.YNc(28,Ct,2,0,"ng-template",15),t.qZA()),2&e){const i=t.MAs(1);t.Q6J("model",l.items),t.xp6(8),t.Q6J("value",l.lstBill)("columns",l.cols)("rows",10)("globalFilterFields",t.DdM(31,Tt))("paginator",!0)("rowsPerPageOptions",t.DdM(32,Et))("showCurrentPageReport",!0)("first",l.first)("lazy",!0)("totalRecords",l.totalRecords)("selection",l.selectedBills)("contextMenu",i)("contextMenuSelection",l.selectedBill)("totalRecords",l.totalRecords),t.xp6(6),t.Akn(t.DdM(33,xt)),t.Q6J("visible",l.billDialog)("header",t.lcZ(15,29,l.appUtil.isEmpty(l.bill)?"label.bill_add":"label.bill_edit"))("modal",!0),t.xp6(4),t.Akn(t.DdM(34,R)),t.Q6J("visible",l.deleteBillDialog)("modal",!0),t.xp6(3),t.Q6J("ngIf",l.bill),t.xp6(2),t.Akn(t.DdM(35,R)),t.Q6J("visible",l.deleteBillsDialog)("modal",!0)}},dependencies:[o.xV,_.sg,_.O5,c.iA,u.jx,c.lQ,c.jB,c.zi,c.YL,c.fz,c.D$,c.Pv,c.U1,c.wT,d.Hq,B.Fj,B.JJ,B.On,y.H,M.FN,w.o,D.o,x.Lt,P.EU,N.Rn,U.V,O.Z,S.Ct,Y.X$,_.JJ],encapsulation:2,data:{animation:[(0,m.X$)("rowExpansionTrigger",[(0,m.SB)("void",(0,m.oB)({transform:"translateX(-10%)",opacity:0})),(0,m.SB)("active",(0,m.oB)({transform:"translateX(0)",opacity:1})),(0,m.eR)("* <=> *",(0,m.jt)("400ms cubic-bezier(0.86, 0, 0.07, 1)"))])]}}),n})()},21726:(I,A,a)=>{"use strict";a.d(A,{v:()=>Z});var f=a(15861),g=a(54004),v=a(92340),m=a(81637),t=a(5e3),T=a(40520);const u=`${m.Z.DEFAULT_URLS.API}/Customers`;let Z=(()=>{class b{constructor(o){this.http=o}getCustomersSmall(){var o=this;return(0,f.Z)(function*(){return yield o.http.get("assets/demo/data/customers-small.json").toPromise().then(_=>_.data).then(_=>_)})()}getCustomersMedium(){var o=this;return(0,f.Z)(function*(){return yield o.http.get("assets/demo/data/customers-medium.json").toPromise().then(_=>_.data).then(_=>_)})()}getCustomersLarge(){var o=this;return(0,f.Z)(function*(){return yield o.http.get("assets/demo/data/customers-large.json").toPromise().then(_=>_.data).then(_=>_)})()}getPagingCustomer(o){return this.http.get(`${u}`,{params:o}).pipe((0,g.U)(_=>_))}getAllCustomer(){return this.http.get(`${u}/list`,{}).pipe((0,g.U)(o=>o))}getCustomerDetail(o){return this.http.get(`${u}/${o}`,{}).pipe((0,g.U)(c=>c))}createCustomer(o){return this.http.post(`${u}`,o).pipe((0,g.U)(c=>c))}updateCustomer(o,_){return this.http.put(`${u}`,o).pipe((0,g.U)(d=>d))}deleteCustomer(o){return this.http.delete(`${u}/${o}`,{}).pipe((0,g.U)(c=>c))}deleteMultipleCustomer(o){return this.http.post(`${u}/multiple`,o).pipe()}getExcelReport(o){return this.http.get(`${u}/export-excel-customer`,{}).pipe((0,g.U)(c=>c))}getFolderPathDownload(o,_){return v.N.serverURL+`/ReportDownload/DownloadReportFromFile?filename=${o}&fileType=${_}`}}return b.\u0275fac=function(o){return new(o||b)(t.LFG(T.eN))},b.\u0275prov=t.Yz7({token:b,factory:b.\u0275fac}),b})()},94327:function(I,A){var g;void 0!==(g=function(){"use strict";function m(p,o,_){var c=new XMLHttpRequest;c.open("GET",p),c.responseType="blob",c.onload=function(){b(c.response,o,_)},c.onerror=function(){console.error("could not download file")},c.send()}function t(p){var o=new XMLHttpRequest;o.open("HEAD",p,!1);try{o.send()}catch(_){}return 200<=o.status&&299>=o.status}function T(p){try{p.dispatchEvent(new MouseEvent("click"))}catch(_){var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),p.dispatchEvent(o)}}var u="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,Z=u.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),b=u.saveAs||("object"!=typeof window||window!==u?function(){}:"download"in HTMLAnchorElement.prototype&&!Z?function(p,o,_){var c=u.URL||u.webkitURL,d=document.createElement("a");d.download=o=o||p.name||"download",d.rel="noopener","string"==typeof p?(d.href=p,d.origin===location.origin?T(d):t(d.href)?m(p,o,_):T(d,d.target="_blank")):(d.href=c.createObjectURL(p),setTimeout(function(){c.revokeObjectURL(d.href)},4e4),setTimeout(function(){T(d)},0))}:"msSaveOrOpenBlob"in navigator?function(p,o,_){if(o=o||p.name||"download","string"!=typeof p)navigator.msSaveOrOpenBlob(function v(p,o){return void 0===o?o={autoBom:!1}:"object"!=typeof o&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(p.type)?new Blob(["\ufeff",p],{type:p.type}):p}(p,_),o);else if(t(p))m(p,o,_);else{var c=document.createElement("a");c.href=p,c.target="_blank",setTimeout(function(){T(c)})}}:function(p,o,_,c){if((c=c||open("","_blank"))&&(c.document.title=c.document.body.innerText="downloading..."),"string"==typeof p)return m(p,o,_);var d="application/octet-stream"===p.type,B=/constructor/i.test(u.HTMLElement)||u.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||d&&B||Z)&&"undefined"!=typeof FileReader){var M=new FileReader;M.onloadend=function(){var x=M.result;x=y?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),c?c.location.href=x:location=x,c=null},M.readAsDataURL(p)}else{var w=u.URL||u.webkitURL,D=w.createObjectURL(p);c?c.location=D:location.href=D,c=null,setTimeout(function(){w.revokeObjectURL(D)},4e4)}});u.saveAs=b.saveAs=b,I.exports=b}.apply(A,[]))&&(I.exports=g)}}]);