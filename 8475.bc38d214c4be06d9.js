"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[8475],{98475:(yt,h,s)=>{s.r(h),s.d(h,{BillModule:()=>Et});var b=s(70085),_=s(69808),u=s(93075),p=s(98952),J=s(88205),f=s(40845),T=s(25787),C=s(17773),x=s(44534),U=s(98018),Z=s(31424),P=s(73407),B=s(14036),v=s(49603),A=s(7010),E=s(15315),I=s(51122),g=s(44930),O=s(94327),r=s(41777),t=s(5e3),y=s(84451),N=s(59783),M=s(62162),w=s(373),S=s(21726),D=s(50330),L=s(74297),R=s(27232);function F(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",20)(1,"button",21),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.openNew())}),t.qZA(),t.TgZ(2,"button",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteSelectedBills())}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("disabled",!e.selectedBills||!e.selectedBills.length)}}function Q(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",23)(1,"h5",24),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",25),t._UZ(5,"i",26),t.TgZ(6,"input",27),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.getParams.searchText=n)})("change",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.getBills())}),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,2,"label.bill_management")),t.xp6(4),t.Q6J("ngModel",e.getParams.searchText)}}function k(i,a){1&i&&(t.TgZ(0,"tr"),t._UZ(1,"th",28),t.TgZ(2,"th")(3,"div",29),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"th")(7,"div",30),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"th",31)(11,"div",30),t._uU(12),t.ALo(13,"translate"),t._UZ(14,"p-sortIcon",32),t.qZA()(),t.TgZ(15,"th",33)(16,"div",30),t._uU(17),t.ALo(18,"translate"),t._UZ(19,"p-sortIcon",34),t.qZA()(),t.TgZ(20,"th",35)(21,"div",36),t._uU(22),t.ALo(23,"translate"),t._UZ(24,"p-sortIcon",37),t.qZA()(),t.TgZ(25,"th",38)(26,"div",39),t._uU(27),t.ALo(28,"translate"),t._UZ(29,"p-sortIcon",40),t.qZA()()()),2&i&&(t.xp6(4),t.hij(" ",t.lcZ(5,6,"label.bill_id")," "),t.xp6(4),t.hij(" ",t.lcZ(9,8,"label.customer_name")," "),t.xp6(4),t.hij(" ",t.lcZ(13,10,"label.bill_code")," "),t.xp6(5),t.hij(" ",t.lcZ(18,12,"label.total_amount")," "),t.xp6(5),t.hij(" ",t.lcZ(23,14,"label.delivery_status")," "),t.xp6(5),t.hij(" ",t.lcZ(28,16,"label.bill_status")," "))}function G(i,a){if(1&i&&t._UZ(0,"p-badge",44),2&i){const e=t.oxw().$implicit,l=t.oxw();t.Q6J("value",l.getDeliveryName(e.deliveryStatus))("severity",l.getDeliveryStatusColor(e.deliveryStatus))}}function K(i,a){if(1&i&&t._UZ(0,"p-badge",44),2&i){const e=t.oxw().$implicit,l=t.oxw();t.Q6J("value",l.getStatusName(e.billStatus))("severity",l.getBillStatusColor(e.billStatus))}}function $(i,a){if(1&i&&(t.TgZ(0,"tr",41)(1,"td"),t._UZ(2,"button",42),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"td"),t.YNc(13,G,1,2,"p-badge",43),t.qZA(),t.TgZ(14,"td"),t.YNc(15,K,1,2,"p-badge",43),t.qZA()()),2&i){const e=a.$implicit,l=a.expanded,n=t.oxw();t.Q6J("pContextMenuRow",e),t.xp6(2),t.Q6J("pRowToggler",e)("icon",l?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(n.getCustomerName(e.customeRId)),t.xp6(2),t.Oqu(e.billCode),t.xp6(2),t.Oqu(t.lcZ(11,9,e.totalAmount)),t.xp6(3),t.Q6J("ngIf",e.deliveryStatus),t.xp6(2),t.Q6J("ngIf",e.billStatus)}}function V(i,a){1&i&&(t.TgZ(0,"tr")(1,"th",49),t._uU(2,"ImeI ID "),t._UZ(3,"p-sortIcon",50),t.qZA(),t.TgZ(4,"th",51),t._uU(5,"Accessory ID "),t._UZ(6,"p-sortIcon",52),t.qZA(),t.TgZ(7,"th",53),t._uU(8,"Price"),t._UZ(9,"p-sortIcon",54),t.qZA(),t.TgZ(10,"th",55),t._uU(11,"Quantity"),t._UZ(12,"p-sortIcon",56),t.qZA(),t.TgZ(13,"th",57),t._uU(14,"Battery Percent"),t._UZ(15,"p-sortIcon",58),t.qZA()())}function j(i,a){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"number"),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"number"),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA()()),2&i){const e=a.$implicit,l=t.oxw(2);t.xp6(2),t.Oqu(l.getImeiName(e.imeIId)),t.xp6(2),t.Oqu(l.getAccessoryName(e.accessorYId)),t.xp6(2),t.Oqu(t.lcZ(7,5,e.price)),t.xp6(3),t.Oqu(t.lcZ(10,7,e.quantity)),t.xp6(3),t.hij("",e.batteryPercent," %")}}function H(i,a){1&i&&(t.TgZ(0,"tr")(1,"td",59),t._uU(2,"There are no order for this bill detail yet."),t.qZA()())}function z(i,a){if(1&i&&(t.TgZ(0,"tr")(1,"td",45)(2,"div",46)(3,"p-table",47),t.YNc(4,V,16,0,"ng-template",10),t.YNc(5,j,13,9,"ng-template",11),t.YNc(6,H,3,0,"ng-template",48),t.qZA()()()()),2&i){const e=a.$implicit;t.xp6(3),t.Q6J("value",e.billDetails)}}function X(i,a){1&i&&(t.TgZ(0,"small",80),t._uU(1,"Customer ID is required."),t.qZA())}function W(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",81)(1,"p-radioButton",82),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw(2);return t.KtG(o.selectedBillStatus=n)}),t.qZA(),t.TgZ(2,"label",83),t._uU(3),t.qZA()()}if(2&i){const e=a.$implicit,l=t.oxw(2);t.xp6(1),t.Q6J("inputId",e.key)("value",e)("ngModel",l.selectedBillStatus),t.xp6(1),t.Q6J("for",e.key),t.xp6(1),t.Oqu(e.name)}}function tt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"div",84)(1,"h4"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div")(5,"button",85),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.onAddBillDetail())}),t.qZA()()()}2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,2,"label.bill_detail_management")),t.xp6(3),t.Q6J("label","Add"))}function et(i,a){1&i&&(t.TgZ(0,"tr")(1,"th",86),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"th",86),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"th",87),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"th",87),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"th",87),t._uU(14),t.ALo(15,"translate"),t.qZA(),t._UZ(16,"th",87),t.qZA()),2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,5,"label.imei_name")),t.xp6(3),t.Oqu(t.lcZ(6,7,"label.accessory_name")),t.xp6(3),t.Oqu(t.lcZ(9,9,"label.price")),t.xp6(3),t.Oqu(t.lcZ(12,11,"label.quantity")),t.xp6(3),t.Oqu(t.lcZ(15,13,"label.battery_percentage")))}function lt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-dropdown",96),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.imeIId=n)}),t.qZA()}if(2&i){const e=t.oxw().$implicit,l=t.oxw(2);t.Q6J("options",l.imeis)("ngModel",e.imeIId)("showClear",!0)}}function it(i,a){if(1&i&&t._uU(0),2&i){const e=t.oxw().$implicit,l=t.oxw(2);t.hij(" ",l.getImeiName(e.imeIId)," ")}}function nt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-dropdown",97),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.accessorYId=n)}),t.qZA()}if(2&i){const e=t.oxw().$implicit,l=t.oxw(2);t.Q6J("options",l.accessories)("ngModel",e.accessorYId)("showClear",!0)}}function ot(i,a){if(1&i&&t._uU(0),2&i){const e=t.oxw().$implicit,l=t.oxw(2);t.hij(" ",l.getAccessoryName(e.accessorYId)," ")}}function at(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-inputNumber",69),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.price=n)}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("ngModel",e.price)}}function st(i,a){if(1&i&&(t._uU(0),t.ALo(1,"number")),2&i){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.price)," ")}}function ct(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-inputNumber",69),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.quantity=n)}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("ngModel",e.quantity)}}function pt(i,a){if(1&i&&(t._uU(0),t.ALo(1,"number")),2&i){const e=t.oxw().$implicit;t.hij(" ",t.lcZ(1,1,e.quantity)," ")}}function rt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-inputNumber",69),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.batteryPercent=n)}),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("ngModel",e.batteryPercent)}}function dt(i,a){if(1&i&&t._uU(0),2&i){const e=t.oxw().$implicit;t.hij(" ",e.batteryPercent," % ")}}function mt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",98),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.onRowEditInit(n))}),t.qZA()}}function _t(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",99),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,o=t.oxw(2);return t.KtG(o.onRowEditSave(n))}),t.qZA()}}function ut(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",100),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(),o=n.$implicit,m=n.rowIndex,It=t.oxw(2);return t.KtG(It.onRowEditCancel(o,m))}),t.qZA()}}function gt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"tr",88)(1,"td")(2,"p-cellEditor"),t.YNc(3,lt,1,3,"ng-template",89),t.YNc(4,it,1,1,"ng-template",90),t.qZA()(),t.TgZ(5,"td")(6,"p-cellEditor"),t.YNc(7,nt,1,3,"ng-template",89),t.YNc(8,ot,1,1,"ng-template",90),t.qZA()(),t.TgZ(9,"td")(10,"p-cellEditor"),t.YNc(11,at,1,1,"ng-template",89),t.YNc(12,st,2,3,"ng-template",90),t.qZA()(),t.TgZ(13,"td")(14,"p-cellEditor"),t.YNc(15,ct,1,1,"ng-template",89),t.YNc(16,pt,2,3,"ng-template",90),t.qZA()(),t.TgZ(17,"td")(18,"p-cellEditor"),t.YNc(19,rt,1,1,"ng-template",89),t.YNc(20,dt,1,1,"ng-template",90),t.qZA()(),t.TgZ(21,"td")(22,"div",91),t.YNc(23,mt,1,0,"button",92),t.YNc(24,_t,1,0,"button",93),t.YNc(25,ut,1,0,"button",94),t.TgZ(26,"button",95),t.NdJ("click",function(){const o=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.deleteBillDetail(o))}),t.qZA()()()()}if(2&i){const l=a.editing;t.Q6J("pEditableRow",a.$implicit),t.xp6(23),t.Q6J("ngIf",!l),t.xp6(1),t.Q6J("ngIf",l),t.xp6(1),t.Q6J("ngIf",l)}}const Y=function(){return{"margin-bottom":"2em"}};function ht(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"p-card",60),t.ALo(1,"translate"),t.TgZ(2,"div",61)(3,"div",62)(4,"label",63),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"input",64),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.billCode=n)}),t.qZA()(),t.TgZ(8,"div",62)(9,"label",65),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"p-dropdown",66),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.customeRId=n)}),t.qZA(),t.YNc(13,X,2,0,"small",67),t.qZA(),t.TgZ(14,"div",62)(15,"label",68),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"p-inputNumber",69),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.totalAmount=n)}),t.qZA()(),t.TgZ(19,"div",70)(20,"label",71),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"p-dropdown",72),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.selectedDeliveryStatus=n)}),t.qZA()(),t.TgZ(24,"div",70)(25,"label",73),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"div",74),t.YNc(29,W,4,5,"div",75),t.qZA()(),t.TgZ(30,"div",76)(31,"label",77),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"input",78),t.NdJ("ngModelChange",function(n){t.CHM(e);const o=t.oxw();return t.KtG(o.bill.description=n)}),t.qZA()()()(),t.TgZ(35,"p-card"),t.YNc(36,tt,6,4,"ng-template",10),t.TgZ(37,"p-table",79),t.YNc(38,et,17,15,"ng-template",10),t.YNc(39,gt,27,4,"ng-template",11),t.qZA()()}if(2&i){const e=t.oxw();t.Akn(t.DdM(37,Y)),t.Q6J("header",t.lcZ(1,23,"label.bill_information")),t.xp6(5),t.Oqu(t.lcZ(6,25,"label.bill_code")),t.xp6(2),t.Q6J("ngModel",e.bill.billCode),t.xp6(3),t.Oqu(t.lcZ(11,27,"label.customer_name")),t.xp6(2),t.Q6J("options",e.customers)("ngModel",e.bill.customeRId)("showClear",!0),t.xp6(1),t.Q6J("ngIf",e.submitted&&!e.bill.customeRId),t.xp6(3),t.Oqu(t.lcZ(17,29,"label.total_amount")),t.xp6(2),t.Q6J("ngModel",e.bill.totalAmount),t.xp6(3),t.Oqu(t.lcZ(22,31,"label.delivery_status")),t.xp6(2),t.Q6J("options",e.deliveryStatus)("ngModel",e.selectedDeliveryStatus)("showClear",!0),t.xp6(3),t.Oqu(t.lcZ(27,33,"label.bill_status")),t.xp6(3),t.Q6J("ngForOf",e.billStatus),t.xp6(3),t.Oqu(t.lcZ(33,35,"label.description")),t.xp6(2),t.Q6J("ngModel",e.bill.description),t.xp6(1),t.Akn(t.DdM(38,Y)),t.xp6(2),t.Q6J("value",e.billDetails)}}function bt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",101),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.hideDialog())}),t.qZA(),t.TgZ(1,"button",102),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.saveBill())}),t.qZA()}}function ft(i,a){if(1&i&&(t.TgZ(0,"span"),t._uU(1,"Are you sure you want to delete "),t.TgZ(2,"b"),t._uU(3),t.qZA(),t._uU(4,"?"),t.qZA()),2&i){const e=t.oxw();t.xp6(3),t.Oqu(e.bill.billCode)}}function Tt(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",103),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteBillDialog=!1)}),t.qZA(),t.TgZ(1,"button",104),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmDelete())}),t.qZA()}}function Ct(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"button",103),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteBillsDialog=!1)}),t.qZA(),t.TgZ(1,"button",104),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.confirmDeleteSelected())}),t.qZA()}}const xt=function(){return["billCode","totalAmount","deliveryStatus","billStatus"]},Zt=function(){return[5,10,20]},Bt=function(){return{width:"70%"}},q=function(){return{width:"450px"}};var d=(()=>{return(i=d||(d={}))[i.NOT_YET_PAYMENT=1]="NOT_YET_PAYMENT",i[i.PAYMENT_COMPLETED=2]="PAYMENT_COMPLETED",d;var i})(),c=(()=>{return(i=c||(c={}))[i.NOT_YET_DELIVERY=1]="NOT_YET_DELIVERY",i[i.DELIVERING=2]="DELIVERING",i[i.DELIVERED=3]="DELIVERED",i[i.DELIVERY_FAILED=4]="DELIVERY_FAILED",i[i.DELIVERY_CANCEL=5]="DELIVERY_CANCEL",c;var i})();let vt=(()=>{class i{constructor(e,l,n,o,m){this.billService=e,this.messageService=l,this.imeiService=n,this.accessoryService=o,this.customerService=m,this.appUtil=g.Z,this.billDialog=!1,this.deleteBillDialog=!1,this.deleteBillsDialog=!1,this.bill={},this.selectedBills=[],this.selectedBill={},this.items=[],this.submitted=!1,this.cols=[],this.rowsPerPageOptions=[5,10,20],this.selectedBillStatus=null,this.billStatus=[{name:"Ch\u01b0a Thanh To\xe1n",key:d.NOT_YET_PAYMENT},{name:"\u0110\xe3 Thanh To\xe1n",key:d.PAYMENT_COMPLETED}],this.selectedDeliveryStatus=null,this.deliveryStatus=[{name:"Ch\u01b0a giao h\xe0ng",code:c.NOT_YET_DELIVERY},{name:"\u0110ang giao h\xe0ng",code:c.DELIVERING},{name:"Giao h\xe0ng th\xe0nh c\xf4ng",code:c.DELIVERED},{name:"Giao h\xe0ng l\u1ed7i",code:c.DELIVERY_FAILED},{name:"\u0110\u01a1n h\xe0ng b\u1ecb h\u1ee7y",code:c.DELIVERY_CANCEL}],this.billDetails=[],this.statuses=[],this.customers=[],this.imeis=[],this.accessories=[],this.loading=!1,this.getParams={page:0,pageSize:5,sortField:"id",isSort:!0,searchText:""},this.lstBill=[],this.bills=[],this.totalRecords=0,this.totalPages=0,this.first=0,this.clonedProducts={}}ngOnInit(){this.getListCustomer(),this.getListImei(),this.getListAccessories(),this.cols=[{field:"accessoryName",header:"Accessory name"},{field:"salePrice",header:"Sale Price"},{field:"description",header:"Description"}],this.statuses=[{label:"In Stock",value:"INSTOCK"},{label:"Low Stock",value:"LOWSTOCK"},{label:"Out of Stock",value:"OUTOFSTOCK"}],this.items=[{label:"View",icon:"pi pi-fw pi-search",command:()=>{this.editBill(this.selectedBill)}},{label:"Delete",icon:"pi pi-fw pi-times",command:()=>{this.deleteBill(this.selectedBill)}}]}getBillStatusColor(e){switch(e){case d.NOT_YET_PAYMENT:return"info";case d.PAYMENT_COMPLETED:return"success"}return""}getDeliveryStatusColor(e){switch(e){case c.NOT_YET_DELIVERY:return"info";case c.DELIVERING:return"warning";case c.DELIVERED:return"success";case c.DELIVERY_FAILED:case c.DELIVERY_CANCEL:return"error"}return""}getListCustomer(){this.customerService.getAllCustomer().subscribe(e=>{this.customers=e.data})}getListImei(){this.imeiService.getAllImei().subscribe(e=>{this.imeis=e.data})}getCustomerName(e){let l=this.customers.find(n=>n.id===e);return l?l.customerName:""}getImeiName(e){let l=this.imeis.find(n=>n.id===e);return l?l.imeiName:""}getAccessoryName(e){let l=this.accessories.find(n=>n.id===e);return l?l.accessoryName:""}getListAccessories(){this.accessoryService.getAllAccessor().subscribe(e=>{this.accessories=e.data})}getBills(e,l=!1){this.pendingRequest&&this.pendingRequest.unsubscribe(),this.loading=!0,e&&(console.log(e),this.getParams.page=e.first/e.rows,this.getParams.pageSize=e.rows+1,this.getParams.sortField=e.sortField,this.getParams.isSort=1===e.sortOrder),l&&this.billService.getExcelReport(this.getParams).subscribe(n=>{g.Z.scrollToTop(),this.openDownloadFile(n.data,"excel")}),Object.keys(this.getParams).forEach(n=>null==this.getParams[n]&&delete this.getParams[n]),this.pendingRequest=this.billService.getPagingBills(this.getParams).subscribe(n=>{g.Z.scrollToTop(),this.lstBill=n.data,this.totalRecords=n.totalItems||0,this.totalPages=n.totalItems/n.pageSize,console.log(this.lstBill),this.loading=!1})}openDownloadFile(e,l){try{var n=this.billService.getFolderPathDownload(e,l);n&&window.open(n)}catch(o){this.messageService.add({severity:"error",summary:"Error Message",detail:"File invalid"})}}openNew(){this.resetValue(),this.submitted=!1,this.billDialog=!0}deleteSelectedBills(){this.deleteBillsDialog=!0}editBill(e){this.bill=Object.assign({},e),this.selectedBillStatus=this.billStatus.filter(l=>l.key===e.billStatus)[0],this.selectedDeliveryStatus=this.deliveryStatus.filter(l=>l.code===e.deliveryStatus)[0],this.billDetails=e.billDetails||[],this.billDialog=!0}resetValue(){this.selectedDeliveryStatus=null,this.selectedBillStatus=null,this.bill={},this.billDetails=[]}deleteBill(e){this.deleteBillDialog=!0,this.bill=Object.assign({},e)}confirmDeleteSelected(){this.billService.deleteMultipleBill(this.selectedBills.map(e=>e.id)).subscribe(()=>{this.deleteBillsDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Deleted",life:3e3}),this.selectedBills=[],this.getBills()})}confirmDelete(){this.billService.deleteBill(this.bill.id).subscribe(e=>{this.deleteBillDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Deleted",life:3e3}),this.bill={billDetails:[]},this.getBills()})}hideDialog(){this.billDialog=!1,this.submitted=!1,this.bill={},this.getBills()}saveBill(){if(this.bill.billDetails&&this.bill.billDetails.filter(l=>l.imeIId&&l.accessorYId||!l.imeIId&&!l.accessorYId).length>0)return void this.messageService.add({severity:"info",summary:"Information",detail:"Please check again"});this.submitted=!0,this.bill.customeR_ID=this.bill.customeRId,this.bill.billStatus=this.selectedBillStatus.key,this.bill.deliveryStatus=this.selectedDeliveryStatus.code;let e=[];this.billDetails.forEach(l=>{l.bilL_ID=l.bilLId,l.imeI_ID=l.imeIId,l.accessorY_ID=l.accessorYId,e.push(l)}),this.bill.billDetails=e,this.bill.id?this.billService.updateBill(this.bill,this.bill.id).subscribe(l=>{console.log(l),this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Updated",life:3e3}),this.hideDialog()}):(this.bill.id=0,this.billService.createBill(this.bill).subscribe(l=>{this.messageService.add({severity:"success",summary:"Successful",detail:"Bill Created",life:3e3}),this.hideDialog()}))}getDeliveryName(e){let l=this.deliveryStatus.find(n=>n.code===e);return l?l.name:""}getStatusName(e){let l=this.billStatus.find(n=>n.key===e);return l?l.name:""}findIndexById(e){let l=-1;for(let n=0;n<this.bills.length;n++)if(this.bills[n].id===e){l=n;break}return l}onAddBillDetail(){this.billDetails.push({imeIId:0,accessorYId:0,price:0,quantity:1,batteryPercent:0})}onGlobalFilter(e,l){e.filterGlobal(l.target.value,"contains")}exportPdf(){s.e(3583).then(s.bind(s,53583)).then(e=>{Promise.all([s.e(3583),s.e(2983)]).then(s.t.bind(s,12983,23)).then(l=>{const n=new e.default;n.autoTable(this.cols,this.bills),n.save("bill.pdf")})})}exportExcel(){s.e(574).then(s.bind(s,80574)).then(e=>{const n={Sheets:{data:e.utils.json_to_sheet(this.bills)},SheetNames:["data"]},o=e.write(n,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(o,"bills")})}saveAsExcelFile(e,l){const m=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});O.saveAs(m,l+"_export_"+(new Date).getTime()+".xlsx")}onRowEditInit(e){this.clonedProducts[e.id]=Object.assign({},e)}onRowEditSave(e){delete this.clonedProducts[e.id]}onRowEditCancel(e,l){this.billDetails[l]=this.clonedProducts[e.id],delete this.clonedProducts[e.id]}deleteBillDetail(e){this.billDetails=this.billDetails.filter(l=>l!==e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(y.C),t.Y36(N.ez),t.Y36(M.s),t.Y36(w.r),t.Y36(S.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-bill"]],decls:29,vars:36,consts:[[3,"model"],["cm",""],[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["styleClass","mb-4"],["pTemplate","left"],["dataKey","id","responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple",3,"value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","first","lazy","totalRecords","selection","contextMenu","contextMenuSelection","firstChange","onLazyLoad","selectionChange","contextMenuSelectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[1,"p-fluid",3,"visible","header","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],[1,"my-2"],["pButton","","pRipple","","label","New","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger",3,"disabled","click"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",1,"w-full","sm:w-auto",3,"ngModel","ngModelChange","change"],[2,"width","1rem"],[1,"flex","align-items-center","w-3rem"],[1,"flex","align-items-center","w-8rem"],["pSortableColumn","billCode"],["field","billCode"],["pSortableColumn","totalAmount"],["field","totalAmount"],["pSortableColumn","deliveryStatus"],[1,"flex","align-items-center","w-12rem"],["field","deliveryStatus"],["pSortableColumn","billStatus"],[1,"flex","align-items-center","w-11rem"],["field","billStatus"],[1,"cursor-pointer",3,"pContextMenuRow"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],[3,"value","severity",4,"ngIf"],[3,"value","severity"],["colspan","12"],[1,"p-3"],["dataKey","id",3,"value"],["pTemplate","emptymessage"],["pSortableColumn","imeIId"],["field","imeIId"],["pSortableColumn","accessorYId"],["field","accessorYId"],["pSortableColumn","price"],["field","price"],["pSortableColumn","quantity"],["field","quantity"],["pSortableColumn","batteryPercent"],["field","batteryPercent"],["colspan","6"],[3,"header"],[1,"form-grid","grid"],[1,"field","col-12","md:col-4"],["for","billCode"],["type","text","pInputText","","id","billCode","autofocus","",3,"ngModel","ngModelChange"],["for","customeRId"],["placeholder","Select Customer","optionLabel","customerName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["class","ng-dirty ng-invalid",4,"ngIf"],["for","totalAmount"],[3,"ngModel","ngModelChange"],[1,"field","col-12","md:col-6"],["for","deliveryStatus"],["placeholder","Select delivery status","optionLabel","name",3,"options","ngModel","showClear","ngModelChange"],["for","billStatus"],[1,"flex","gap-8"],["class","field-checkbox",4,"ngFor","ngForOf"],[1,"field","col-12"],["for","description"],["type","text","pInputText","","id","description",3,"ngModel","ngModelChange"],["dataKey","id","editMode","row",3,"value"],[1,"ng-dirty","ng-invalid"],[1,"field-checkbox"],["name","billStatus",3,"inputId","value","ngModel","ngModelChange"],[3,"for"],[1,"flex","justify-content-between","px-4","pt-4"],["pButton","","pRipple","","icon","pi pi-plus",3,"label","click"],[2,"width","20%"],[2,"width","15%"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","icon","pi pi-pencil","class","p-button-rounded p-button-warning","pInitEditableRow","",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","class","p-button-rounded p-button-text p-button-success mr-2",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","class","p-button-rounded p-button-text p-button-danger",3,"click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],["placeholder","Select Imei","optionLabel","imeiName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["placeholder","Select Accessory","optionLabel","accessoryName","optionValue","id",3,"options","ngModel","showClear","ngModelChange"],["pButton","","pRipple","","icon","pi pi-pencil","pInitEditableRow","",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check",1,"p-button-rounded","p-button-text","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"]],template:function(e,l){if(1&e&&(t._UZ(0,"p-contextMenu",0,1),t.TgZ(2,"div",2)(3,"div",3)(4,"div",4),t._UZ(5,"p-toast"),t.TgZ(6,"p-toolbar",5),t.YNc(7,F,3,1,"ng-template",6),t.qZA(),t.TgZ(8,"p-table",7,8),t.NdJ("firstChange",function(o){return l.first=o})("onLazyLoad",function(o){return l.getBills(o)})("selectionChange",function(o){return l.selectedBills=o})("contextMenuSelectionChange",function(o){return l.selectedBill=o}),t.YNc(10,Q,7,4,"ng-template",9),t.YNc(11,k,30,18,"ng-template",10),t.YNc(12,$,16,11,"ng-template",11),t.YNc(13,z,7,1,"ng-template",12),t.qZA()()()(),t.TgZ(14,"p-dialog",13),t.NdJ("visibleChange",function(o){return l.billDialog=o}),t.ALo(15,"translate"),t.YNc(16,ht,40,39,"ng-template",14),t.YNc(17,bt,2,0,"ng-template",15),t.qZA(),t.TgZ(18,"p-dialog",16),t.NdJ("visibleChange",function(o){return l.deleteBillDialog=o}),t.TgZ(19,"div",17),t._UZ(20,"i",18),t.YNc(21,ft,5,1,"span",19),t.qZA(),t.YNc(22,Tt,2,0,"ng-template",15),t.qZA(),t.TgZ(23,"p-dialog",16),t.NdJ("visibleChange",function(o){return l.deleteBillsDialog=o}),t.TgZ(24,"div",17),t._UZ(25,"i",18),t.TgZ(26,"span"),t._uU(27,"Are you sure you want to delete selected accessory?"),t.qZA()(),t.YNc(28,Ct,2,0,"ng-template",15),t.qZA()),2&e){const n=t.MAs(1);t.Q6J("model",l.items),t.xp6(8),t.Q6J("value",l.lstBill)("columns",l.cols)("rows",10)("globalFilterFields",t.DdM(31,xt))("paginator",!0)("rowsPerPageOptions",t.DdM(32,Zt))("showCurrentPageReport",!0)("first",l.first)("lazy",!0)("totalRecords",l.totalRecords)("selection",l.selectedBills)("contextMenu",n)("contextMenuSelection",l.selectedBill)("totalRecords",l.totalRecords),t.xp6(6),t.Akn(t.DdM(33,Bt)),t.Q6J("visible",l.billDialog)("header",t.lcZ(15,29,l.appUtil.isEmpty(l.bill)?"label.bill_add":"label.bill_edit"))("modal",!0),t.xp6(4),t.Akn(t.DdM(34,q)),t.Q6J("visible",l.deleteBillDialog)("modal",!0),t.xp6(3),t.Q6J("ngIf",l.bill),t.xp6(2),t.Akn(t.DdM(35,q)),t.Q6J("visible",l.deleteBillsDialog)("modal",!0)}},dependencies:[D.xV,_.sg,_.O5,p.iA,N.jx,p.lQ,p.jB,p.zi,p.YL,p.fz,p.D$,p.Pv,p.U1,p.wT,f.Hq,u.Fj,u.JJ,u.On,T.H,C.FN,x.o,Z.o,B.Lt,v.EU,A.Rn,E.V,L.Z,b.Ct,R.X$,_.JJ],encapsulation:2,data:{animation:[(0,r.X$)("rowExpansionTrigger",[(0,r.SB)("void",(0,r.oB)({transform:"translateX(-10%)",opacity:0})),(0,r.SB)("active",(0,r.oB)({transform:"translateX(0)",opacity:1})),(0,r.eR)("* <=> *",(0,r.jt)("400ms cubic-bezier(0.86, 0, 0.07, 1)"))])]}}),i})(),At=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[I.Bz.forChild([{path:"",component:vt}]),I.Bz]}),i})(),Et=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[S.v,w.r,y.C,M.s],imports:[D.vI,R.aw,_.ez,At,p.U$,J.O,u.u5,f.hJ,T.T,C.EV,x.V,U.Xt,Z.j,P.A,B.kW,v.cc,A.L$,E.S,L.d,b.TX]}),i})()}}]);